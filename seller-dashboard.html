<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Seller Dashboard â€” Family Nest Auctions</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400;1,600&family=Jost:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --green-deep:   #3A7A5C;--green-mid:    #4E9470;--green-sage:   #7DB88A;--green-light:  #B8D4AE;--green-pale:   #EEF7EE;
  --honey:#C8A96E;--honey-light:#DFC28E;--honey-pale:#F5EDD8;
  --cream:#FAF7F2;--cream-mid:#F0EBE3;--cream-dark:#E2D9CE;
  --charcoal:#2C2C2C;--text-mid:#666;--text-light:#999;--white:#fff;
  --red:#B03030;--red-pale:#FDECEA;--orange:#D4804A;--blue:#3B6CB0;--blue-pale:#EBF0FA;
  --r-sm:8px;--r-md:14px;--r-lg:22px;
  --sh-xs:0 2px 8px rgba(44,44,44,.06);--sh-sm:0 4px 18px rgba(44,44,44,.09);
  --sh-md:0 8px 36px rgba(44,44,44,.13);--sh-lg:0 16px 56px rgba(44,44,44,.18);
}
*{margin:0;padding:0;box-sizing:border-box}
html{scroll-behavior:smooth}
body{font-family:'Jost',sans-serif;background:var(--cream);color:var(--charcoal);overflow-x:hidden;display:flex;flex-direction:column;min-height:100vh}

/* â”€â”€ HEADER â”€â”€ */
header{position:fixed;top:0;left:0;right:0;z-index:800;background:var(--green-deep);box-shadow:0 2px 20px rgba(0,0,0,.2);height:68px;display:flex;align-items:center;justify-content:space-between;padding:0 28px;gap:16px}
.logo-wrap{display:flex;align-items:center;gap:10px;text-decoration:none;flex-shrink:0}
.logo-mark{width:36px;height:36px}
.logo-text .logo-name{font-family:'Cormorant Garamond',serif;font-size:17px;font-weight:700;color:var(--white);line-height:1}
.logo-text .logo-sub{font-size:8.5px;font-weight:700;letter-spacing:.16em;text-transform:uppercase;color:var(--honey)}
.hd-center{flex:1;display:flex;justify-content:center}
.hd-badge{background:rgba(200,169,110,.18);border:1px solid rgba(200,169,110,.35);color:var(--honey);font-size:12px;font-weight:700;padding:5px 14px;border-radius:100px;letter-spacing:.06em}
.hd-right{display:flex;align-items:center;gap:12px;flex-shrink:0}
.hd-notif{position:relative;background:transparent;border:none;cursor:pointer;font-size:20px;color:rgba(255,255,255,.75);padding:4px}
.hd-notif .badge{position:absolute;top:-2px;right:-2px;background:var(--red);color:white;font-size:9px;font-weight:700;width:15px;height:15px;border-radius:50%;display:flex;align-items:center;justify-content:center;border:2px solid var(--green-deep)}
.hd-avatar{width:34px;height:34px;border-radius:50%;background:var(--honey);color:var(--green-deep);font-size:14px;font-weight:700;display:flex;align-items:center;justify-content:center;cursor:pointer;border:2px solid rgba(255,255,255,.2)}
.hd-view-site{font-size:12.5px;font-weight:600;color:rgba(255,255,255,.7);text-decoration:none;padding:7px 14px;border:1.5px solid rgba(255,255,255,.2);border-radius:var(--r-sm);transition:all .2s;font-family:'Jost',sans-serif;background:transparent;cursor:pointer}
.hd-view-site:hover{border-color:var(--honey);color:var(--honey)}

/* â”€â”€ SIDEBAR â”€â”€ */
.app-body{display:flex;margin-top:68px;flex:1}
.sidebar{width:240px;min-width:240px;background:var(--white);border-right:1px solid var(--cream-dark);height:calc(100vh - 68px);position:sticky;top:68px;overflow-y:auto;display:flex;flex-direction:column}
.sidebar::-webkit-scrollbar{width:4px}
.sidebar::-webkit-scrollbar-thumb{background:var(--cream-dark);border-radius:2px}
.sidebar-section{padding:20px 0 8px}
.sidebar-label{font-size:10px;font-weight:700;letter-spacing:.12em;text-transform:uppercase;color:var(--text-light);padding:0 20px;margin-bottom:6px}
.nav-item{display:flex;align-items:center;gap:10px;padding:10px 20px;font-size:13.5px;font-weight:500;color:var(--text-mid);cursor:pointer;transition:all .2s;border-left:3px solid transparent;user-select:none;border:none;background:transparent;width:100%;text-align:left;font-family:'Jost',sans-serif}
.nav-item:hover{background:var(--cream);color:var(--charcoal)}
.nav-item.active{background:var(--green-pale);color:var(--green-deep);font-weight:700;border-left:3px solid var(--green-deep)}
.nav-icon{font-size:16px;width:22px;flex-shrink:0;text-align:center}
.nav-badge{margin-left:auto;background:var(--honey);color:var(--green-deep);font-size:10px;font-weight:700;padding:1px 7px;border-radius:100px}
.nav-badge.red{background:var(--red);color:white}
.sidebar-footer{margin-top:auto;padding:16px 20px;border-top:1px solid var(--cream-mid)}
.seller-score-card{background:var(--green-pale);border-radius:var(--r-md);padding:14px}
.sc-label{font-size:10.5px;font-weight:700;letter-spacing:.08em;text-transform:uppercase;color:var(--green-mid);margin-bottom:6px}
.sc-score{font-family:'Cormorant Garamond',serif;font-size:32px;font-weight:700;color:var(--green-deep);line-height:1}
.sc-stars{color:var(--honey);font-size:14px;margin-bottom:2px}
.sc-sub{font-size:11.5px;color:var(--text-mid)}

/* â”€â”€ MAIN â”€â”€ */
.main{flex:1;padding:28px 32px 60px;overflow-y:auto;min-width:0}
.page-header{margin-bottom:28px}
.ph-top{display:flex;align-items:flex-start;justify-content:space-between;gap:16px;flex-wrap:wrap;margin-bottom:6px}
.ph-title{font-family:'Cormorant Garamond',serif;font-size:clamp(24px,3vw,36px);font-weight:700;color:var(--charcoal)}
.ph-sub{font-size:14px;color:var(--text-mid)}
.btn-primary{padding:11px 22px;background:var(--green-deep);color:white;border:none;border-radius:var(--r-sm);font-size:13.5px;font-weight:700;font-family:'Jost',sans-serif;cursor:pointer;transition:all .2s;display:flex;align-items:center;gap:7px}
.btn-primary:hover{background:var(--green-mid);transform:translateY(-1px);box-shadow:0 4px 14px rgba(46,85,64,.3)}
.btn-secondary{padding:10px 18px;background:transparent;border:1.5px solid var(--cream-dark);border-radius:var(--r-sm);font-size:13px;font-weight:600;font-family:'Jost',sans-serif;cursor:pointer;color:var(--charcoal);transition:all .2s}
.btn-secondary:hover{border-color:var(--green-mid);color:var(--green-mid)}

/* Tab panels */
.tab-panel{display:none}
.tab-panel.active{display:block}

/* â”€â”€ STAT CARDS â”€â”€ */
.stat-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:16px;margin-bottom:28px}
.stat-card{background:var(--white);border-radius:var(--r-lg);padding:20px;box-shadow:var(--sh-xs);position:relative;overflow:hidden}
.stat-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px}
.stat-card.green::before{background:linear-gradient(90deg,var(--green-deep),var(--green-sage))}
.stat-card.honey::before{background:linear-gradient(90deg,var(--honey),var(--honey-light))}
.stat-card.blue::before{background:linear-gradient(90deg,var(--blue),#6B9FD4)}
.stat-card.red::before{background:linear-gradient(90deg,var(--red),var(--orange))}
.stat-icon{font-size:24px;margin-bottom:10px}
.stat-val{font-family:'Cormorant Garamond',serif;font-size:32px;font-weight:700;color:var(--charcoal);line-height:1;margin-bottom:3px}
.stat-label{font-size:12px;color:var(--text-mid);font-weight:500}
.stat-delta{font-size:11.5px;margin-top:6px;font-weight:600}
.stat-delta.up{color:#2a6040}
.stat-delta.down{color:var(--red)}

/* â”€â”€ SECTION CARD â”€â”€ */
.section-card{background:var(--white);border-radius:var(--r-lg);padding:22px;box-shadow:var(--sh-xs);margin-bottom:22px}
.sc-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;gap:10px;flex-wrap:wrap}
.sc-title{font-family:'Cormorant Garamond',serif;font-size:20px;font-weight:700;color:var(--charcoal)}
.sc-link{font-size:13px;font-weight:600;color:var(--green-mid);background:transparent;border:none;cursor:pointer;font-family:'Jost',sans-serif}
.sc-link:hover{text-decoration:underline}

/* â”€â”€ LISTING ROWS â”€â”€ */
.listing-row{display:flex;gap:14px;align-items:flex-start;padding:14px 0;border-bottom:1px solid var(--cream-mid)}
.listing-row:last-child{border-bottom:none}
.listing-thumb{width:64px;height:64px;min-width:64px;border-radius:var(--r-sm);display:flex;align-items:center;justify-content:center;font-size:28px}
.listing-content{flex:1;min-width:0}
.listing-name{font-size:14.5px;font-weight:700;color:var(--charcoal);margin-bottom:3px;line-height:1.3}
.listing-meta{font-size:12px;color:var(--text-mid);margin-bottom:6px}
.listing-tags{display:flex;flex-wrap:wrap;gap:5px}
.tag{display:inline-flex;align-items:center;gap:3px;font-size:11px;font-weight:600;padding:3px 9px;border-radius:100px}
.tag.live{background:var(--green-pale);color:var(--green-deep)}
.tag.draft{background:var(--cream-mid);color:var(--text-mid)}
.tag.pending{background:var(--honey-pale);color:#7a5a20}
.tag.sold{background:#d4edda;color:#2a6040}
.tag.ended{background:var(--red-pale);color:var(--red)}
.listing-right{text-align:right;flex-shrink:0}
.listing-bid{font-family:'Cormorant Garamond',serif;font-size:20px;font-weight:700;color:var(--charcoal)}
.listing-bids{font-size:11.5px;color:var(--text-light)}
.listing-time{font-size:12px;color:var(--text-mid);margin-top:2px}
.listing-time.urgent{color:var(--red);font-weight:600}
.listing-actions{display:flex;gap:6px;margin-top:8px;justify-content:flex-end}
.act-btn{padding:5px 12px;font-size:12px;font-weight:600;border-radius:var(--r-sm);cursor:pointer;font-family:'Jost',sans-serif;border:1.5px solid;transition:all .2s}
.act-btn.edit{border-color:var(--green-sage);color:var(--green-mid);background:transparent}
.act-btn.edit:hover{background:var(--green-pale)}
.act-btn.danger{border-color:var(--red);color:var(--red);background:transparent}
.act-btn.danger:hover{background:var(--red-pale)}
.act-btn.view{border-color:var(--cream-dark);color:var(--text-mid);background:transparent}
.act-btn.view:hover{border-color:var(--charcoal);color:var(--charcoal)}

/* â”€â”€ UPLOAD FORM â”€â”€ */
.upload-form{display:grid;grid-template-columns:1fr 1fr;gap:22px}
.form-group{display:flex;flex-direction:column;gap:6px}
.form-group.full{grid-column:1/-1}
.form-label{font-size:12.5px;font-weight:700;color:var(--charcoal);letter-spacing:.03em}
.form-label .req{color:var(--red)}
.form-input,.form-select,.form-textarea{border:1.5px solid var(--cream-dark);border-radius:var(--r-sm);padding:10px 13px;font-size:14px;font-family:'Jost',sans-serif;color:var(--charcoal);outline:none;transition:border-color .2s;background:var(--white)}
.form-input:focus,.form-select:focus,.form-textarea:focus{border-color:var(--green-mid);box-shadow:0 0 0 3px var(--green-pale)}
.form-textarea{min-height:100px;resize:vertical}
.form-select{-webkit-appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6'%3E%3Cpath d='M0 0l5 6 5-6z' fill='%23999'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center;padding-right:32px;cursor:pointer}
.form-hint{font-size:11.5px;color:var(--text-light);margin-top:1px}

/* Photo upload zone */
.photo-zone{border:2px dashed var(--cream-dark);border-radius:var(--r-lg);padding:36px;text-align:center;cursor:pointer;transition:all .3s;background:var(--cream)}
.photo-zone:hover,.photo-zone.dragover{border-color:var(--green-sage);background:var(--green-pale)}
.pz-icon{font-size:36px;margin-bottom:10px}
.pz-title{font-size:15px;font-weight:700;color:var(--charcoal);margin-bottom:4px}
.pz-sub{font-size:13px;color:var(--text-light)}
.photo-grid{display:flex;flex-wrap:wrap;gap:10px;margin-top:14px}
.photo-thumb-uploaded{width:80px;height:80px;border-radius:var(--r-sm);background:var(--cream-mid);display:flex;align-items:center;justify-content:center;font-size:30px;position:relative;cursor:pointer;border:2px solid var(--cream-dark)}
.photo-thumb-uploaded .remove-btn{position:absolute;top:-6px;right:-6px;background:var(--red);color:white;border:none;border-radius:50%;width:18px;height:18px;font-size:10px;cursor:pointer;display:flex;align-items:center;justify-content:center;line-height:1}
.photo-thumb-uploaded.primary{border-color:var(--green-deep)}
.photo-primary-badge{position:absolute;bottom:4px;left:50%;transform:translateX(-50%);background:var(--green-deep);color:white;font-size:9px;font-weight:700;padding:1px 6px;border-radius:4px;white-space:nowrap}

/* Condition row */
.cond-picker{display:flex;gap:10px;flex-wrap:wrap}
.cond-opt{flex:1;min-width:100px;border:1.5px solid var(--cream-dark);border-radius:var(--r-sm);padding:10px 12px;cursor:pointer;transition:all .2s;text-align:center}
.cond-opt:hover{border-color:var(--green-sage)}
.cond-opt.selected{border-color:var(--green-deep);background:var(--green-pale)}
.cond-opt-dot{width:10px;height:10px;border-radius:50%;margin:0 auto 5px}
.cond-opt-label{font-size:12.5px;font-weight:700;color:var(--charcoal)}
.cond-opt-desc{font-size:10.5px;color:var(--text-light);margin-top:2px}

/* AI assist button */
.ai-btn{display:flex;align-items:center;gap:7px;padding:9px 16px;background:linear-gradient(135deg,var(--honey-pale),#ede8d8);border:1.5px solid var(--honey);border-radius:var(--r-sm);font-size:13px;font-weight:700;color:#7a5a20;cursor:pointer;font-family:'Jost',sans-serif;transition:all .2s}
.ai-btn:hover{background:linear-gradient(135deg,var(--honey),var(--honey-light));color:var(--green-deep)}

/* â”€â”€ PAYOUTS â”€â”€ */
.payout-summary{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:14px;margin-bottom:20px}
.pay-card{background:var(--cream);border-radius:var(--r-md);padding:16px}
.pay-label{font-size:11px;font-weight:700;letter-spacing:.08em;text-transform:uppercase;color:var(--text-light);margin-bottom:5px}
.pay-val{font-family:'Cormorant Garamond',serif;font-size:26px;font-weight:700;color:var(--charcoal)}
.pay-val.green{color:var(--green-deep)}
.pay-sub{font-size:12px;color:var(--text-mid);margin-top:2px}

.payout-table{width:100%;border-collapse:collapse}
.payout-table th{font-size:11.5px;font-weight:700;letter-spacing:.06em;text-transform:uppercase;color:var(--text-light);padding:8px 10px;text-align:left;border-bottom:2px solid var(--cream-dark)}
.payout-table td{font-size:13.5px;padding:12px 10px;border-bottom:1px solid var(--cream-mid);vertical-align:middle}
.payout-table tr:last-child td{border-bottom:none}
.payout-table tr:hover td{background:var(--cream)}
.pay-status{display:inline-flex;align-items:center;gap:4px;font-size:12px;font-weight:700;padding:3px 10px;border-radius:100px}
.pay-status.paid{background:#d4edda;color:#2a6040}
.pay-status.pending{background:var(--honey-pale);color:#7a5a20}
.pay-status.processing{background:var(--blue-pale);color:var(--blue)}

/* â”€â”€ ANALYTICS â”€â”€ */
.analytics-grid{display:grid;grid-template-columns:1fr 1fr;gap:22px;margin-bottom:22px}
.chart-card{background:var(--white);border-radius:var(--r-lg);padding:22px;box-shadow:var(--sh-xs)}
.chart-title{font-family:'Cormorant Garamond',serif;font-size:18px;font-weight:700;color:var(--charcoal);margin-bottom:16px}
.bar-chart{display:flex;align-items:flex-end;gap:6px;height:120px}
.bar-wrap{flex:1;display:flex;flex-direction:column;align-items:center;gap:4px}
.bar{width:100%;border-radius:4px 4px 0 0;background:var(--green-sage);transition:height .5s ease;cursor:pointer;position:relative}
.bar:hover{background:var(--green-mid)}
.bar-tooltip{position:absolute;top:-26px;left:50%;transform:translateX(-50%);background:var(--charcoal);color:white;font-size:10px;font-weight:700;padding:2px 7px;border-radius:4px;white-space:nowrap;opacity:0;pointer-events:none;transition:opacity .2s}
.bar:hover .bar-tooltip{opacity:1}
.bar-label{font-size:10px;color:var(--text-light);text-align:center}
.mini-table{width:100%}
.mt-row{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid var(--cream-mid);font-size:13px}
.mt-row:last-child{border-bottom:none}
.mt-label{color:var(--text-mid)}
.mt-val{font-weight:700;color:var(--charcoal)}

/* â”€â”€ SALE MANAGEMENT â”€â”€ */
.sale-card{background:var(--white);border-radius:var(--r-lg);padding:18px;box-shadow:var(--sh-xs);margin-bottom:14px;display:flex;gap:16px;align-items:flex-start}
.sale-status-bar{width:5px;min-height:80px;border-radius:3px;flex-shrink:0}
.sale-status-bar.live{background:linear-gradient(180deg,var(--green-deep),var(--green-sage))}
.sale-status-bar.upcoming{background:linear-gradient(180deg,var(--honey),var(--honey-light))}
.sale-status-bar.draft{background:var(--cream-dark)}
.sale-content{flex:1;min-width:0}
.sale-title{font-size:16px;font-weight:700;color:var(--charcoal);margin-bottom:3px}
.sale-meta{font-size:12.5px;color:var(--text-mid);margin-bottom:10px}
.sale-stats{display:flex;gap:16px;flex-wrap:wrap}
.ss-item{font-size:12.5px;color:var(--text-mid)}
.ss-item strong{color:var(--charcoal)}
.sale-actions{display:flex;gap:8px;flex-shrink:0;flex-wrap:wrap;align-self:center}

/* â”€â”€ SHIPPING â”€â”€ */
.ship-row{display:grid;grid-template-columns:2fr 1fr 1fr 1fr auto;gap:12px;align-items:center;padding:12px 0;border-bottom:1px solid var(--cream-mid);font-size:13px}
.ship-row:last-child{border-bottom:none}
.ship-row.header{font-size:11px;font-weight:700;letter-spacing:.06em;text-transform:uppercase;color:var(--text-light);padding-bottom:6px}
.ship-status{display:inline-flex;align-items:center;gap:4px;font-size:11.5px;font-weight:700;padding:3px 9px;border-radius:100px}
.ship-status.shipped{background:#d4edda;color:#2a6040}
.ship-status.pending{background:var(--honey-pale);color:#7a5a20}
.ship-status.label{background:var(--blue-pale);color:var(--blue)}
.btn-ship{padding:5px 13px;background:var(--green-deep);color:white;border:none;border-radius:var(--r-sm);font-size:12px;font-weight:700;cursor:pointer;font-family:'Jost',sans-serif;transition:background .2s}
.btn-ship:hover{background:var(--green-mid)}

/* â”€â”€ REVIEWS â”€â”€ */
.review-row{padding:14px 0;border-bottom:1px solid var(--cream-mid)}
.review-row:last-child{border-bottom:none}
.review-head{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:6px;gap:10px;flex-wrap:wrap}
.review-name{font-size:14px;font-weight:700;color:var(--charcoal)}
.review-date{font-size:12px;color:var(--text-light)}
.review-stars{color:var(--honey);font-size:14px;margin-bottom:5px}
.review-text{font-size:13.5px;color:var(--text-mid);line-height:1.7}
.review-item{font-size:12px;color:var(--text-light);margin-top:4px}

/* â”€â”€ TOAST â”€â”€ */
.toast{position:fixed;bottom:22px;right:22px;background:var(--charcoal);color:white;padding:14px 20px;border-radius:var(--r-md);font-size:13.5px;max-width:290px;box-shadow:var(--sh-lg);border-left:4px solid var(--honey);transform:translateX(140%);transition:transform .3s;z-index:9999}
.toast.on{transform:none}
.toast strong{color:var(--honey);display:block;margin-bottom:3px}

/* â”€â”€ OVERLAY / MODAL â”€â”€ */
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(4px);z-index:900;display:flex;align-items:center;justify-content:center;padding:20px;opacity:0;pointer-events:none;transition:opacity .3s}
.overlay.on{opacity:1;pointer-events:all}
.modal{background:var(--white);border-radius:var(--r-lg);padding:32px;max-width:520px;width:100%;max-height:90vh;overflow-y:auto;position:relative;transform:translateY(16px);transition:transform .3s}
.overlay.on .modal{transform:none}
.modal-x{position:absolute;top:14px;right:14px;width:30px;height:30px;background:var(--cream-mid);border:none;border-radius:50%;cursor:pointer;font-size:14px;display:flex;align-items:center;justify-content:center}
.modal h2{font-family:'Cormorant Garamond',serif;font-size:26px;font-weight:700;color:var(--charcoal);margin-bottom:6px}
.modal .modal-sub{font-size:14px;color:var(--text-mid);margin-bottom:22px}

/* â”€â”€ RESPONSIVE â”€â”€ */
@media(max-width:900px){.sidebar{display:none}
  .main{padding:18px 16px 60px}
  .analytics-grid{grid-template-columns:1fr}
  .upload-form{grid-template-columns:1fr}
  .upload-form .form-group.full{grid-column:1}
  .ship-row{grid-template-columns:1fr 1fr;gap:8px}
  .ship-row.header{display:none}
}

  @media(max-width:900px){
    .sidebar{display:none}
    .main{padding:16px 16px 60px}
    .stat-grid{grid-template-columns:repeat(2,1fr);gap:12px}
    .analytics-grid{grid-template-columns:1fr}
    .upload-form{grid-template-columns:1fr}
    .upload-form .form-group.full{grid-column:1}
    .ship-row{grid-template-columns:1fr 1fr;gap:8px;font-size:12.5px}
    .ship-row.header{display:none}
    .listing-row{flex-wrap:wrap;gap:8px}
    .listing-right{flex-direction:row;align-items:center;gap:10px;width:100%}
    .cond-picker{flex-direction:column}
    .cond-opt{min-width:unset}
    .payout-table{font-size:12px}
    .payout-table th:nth-child(3),.payout-table td:nth-child(3){display:none}
    .sale-card{flex-wrap:wrap}
    .sale-actions{width:100%;justify-content:flex-start}
  }
  @media(max-width:500px){
    .stat-grid{grid-template-columns:repeat(2,1fr)}
    .page-header .ph-top{flex-direction:column;align-items:flex-start}
    .payout-summary{grid-template-columns:repeat(2,1fr)}
    .bar-chart{height:90px}
  }

  
/* â”€â”€ MOBILE MENU OVERLAY â”€â”€ */
.mobile-menu{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:var(--green-deep);z-index:9999;flex-direction:column;align-items:center;justify-content:center;gap:28px;opacity:0;pointer-events:none;transition:opacity .3s}
.mobile-menu.open{display:flex;opacity:1;pointer-events:all}
.mobile-menu a{font-family:'Cormorant Garamond',serif;font-size:34px;font-weight:700;color:var(--white);text-decoration:none}
.mobile-menu a:hover{color:var(--honey)}
.mobile-menu-ctas{display:flex;flex-direction:column;gap:12px;align-items:center;margin-top:8px}
.mobile-close{position:absolute;top:24px;right:24px;background:transparent;border:none;color:var(--white);font-size:32px;cursor:pointer;z-index:10000}
.hamburger{display:none;flex-direction:column;gap:5px;cursor:pointer;padding:8px;background:transparent;border:none;z-index:10000}
.hamburger span{display:block;width:24px;height:2px;background:#fff;border-radius:2px;transition:all .3s}
.hamburger.open span:nth-child(1){transform:translateY(7px) rotate(45deg)}
.hamburger.open span:nth-child(2){opacity:0}
.hamburger.open span:nth-child(3){transform:translateY(-7px) rotate(-45deg)}
@media(max-width:960px){.hamburger{display:flex!important}}

</style>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <script src="js/api.js"></script>
</head>
<body>

<!-- HEADER -->
<header>
  <a href="family-nest-auctions.html" class="logo-wrap">
    <svg class="logo-mark" viewBox="0 0 40 40" fill="none">
      <rect width="40" height="40" rx="8" fill="#C8A96E"/>
      <path d="M20 6L5 17.5V34h10V25h10v9h10V17.5L20 6z" fill="#3A7A5C"/>
      <ellipse cx="20" cy="28.5" rx="5" ry="2.2" fill="#7DB88A" opacity=".75"/>
      <path d="M16 28.5 Q20 25.5 24 28.5" stroke="#B8D4AE" stroke-width="1.1" fill="none" opacity=".8"/>
    </svg>
    <div class="logo-text">
      <div class="logo-name">Family Nest Auctions</div>
      <div class="logo-sub">Seller Portal</div>
    </div>
  </a>
  <div class="hd-center">
    <span class="hd-badge">ğŸŸ¢ Henderson Estate â€” 3 Live Sales</span>
  </div>
  <div class="hd-right">
    <button class="hd-notif" onclick="toast('3 new shipping reminders','ğŸ”” Notifications')">ğŸ””<span class="badge">3</span></button>
    <a href="auction-browse.html" class="hd-view-site">â† View Site</a>
    <div class="hd-avatar" onclick="toast('Account settings coming soon','ğŸ‘¤ Profile')">HS</div>
  </div>
<button class="hamburger" id="hamburger" onclick="toggleMenu()" aria-label="Menu"><span></span><span></span><span></span></button>
</header>

<div class="mobile-menu" id="mobile-menu">
  <button class="mobile-close" onclick="toggleMenu()">âœ•</button>
  <a href="family-nest-auctions.html" onclick="toggleMenu()">Home</a>
  <a href="auction-browse.html" onclick="toggleMenu()">Live Auctions</a>
  <a href="family-nest-auctions.html#how" onclick="toggleMenu()">How It Works</a>
  <a href="seller-dashboard.html" onclick="toggleMenu()">Sell With Us</a>
  <a href="account-dashboard.html" onclick="toggleMenu()">My Account</a>
  <div class="mobile-menu-ctas">
    <button onclick="toggleMenu();window.location.href='family-nest-auctions.html?register=1'" style="width:220px;padding:14px;background:var(--honey);border:none;border-radius:10px;font-size:15px;font-weight:700;cursor:pointer;font-family:'Jost',sans-serif">Start Bidding Free</button>
    <button onclick="toggleMenu();window.location.href='family-nest-auctions.html?login=1'" style="width:220px;padding:13px;background:transparent;border:2px solid rgba(255,255,255,.5);border-radius:10px;font-size:15px;font-weight:700;cursor:pointer;color:white;font-family:'Jost',sans-serif">Sign In</button>
  </div>
</div>



<div class="app-body">

  <!-- SIDEBAR -->
  <nav class="sidebar">
    <div class="sidebar-section">
      <div class="sidebar-label">Overview</div>
      <button class="nav-item active" onclick="switchTab('overview',this)"><span class="nav-icon">ğŸ“Š</span>Dashboard</button>
      <button class="nav-item" onclick="switchTab('analytics',this)"><span class="nav-icon">ğŸ“ˆ</span>Analytics</button>
    </div>
    <div class="sidebar-section">
      <div class="sidebar-label">Listings</div>
      <button class="nav-item" onclick="switchTab('listings',this)"><span class="nav-icon">ğŸ“¦</span>My Listings<span class="nav-badge">24</span></button>
      <button class="nav-item" onclick="switchTab('upload',this)"><span class="nav-icon">â•</span>Add New Item</button>
      <button class="nav-item" onclick="switchTab('sales',this)"><span class="nav-icon">ğŸ¡</span>My Estate Sales</button>
    </div>
    <div class="sidebar-section">
      <div class="sidebar-label">Orders</div>
      <button class="nav-item" onclick="switchTab('shipping',this)"><span class="nav-icon">ğŸšš</span>Shipping<span class="nav-badge red">5</span></button>
      <button class="nav-item" onclick="switchTab('payouts',this)"><span class="nav-icon">ğŸ’°</span>Payouts</button>
    </div>
    <div class="sidebar-section">
      <div class="sidebar-label">Reputation</div>
      <button class="nav-item" onclick="switchTab('reviews',this)"><span class="nav-icon">â­</span>Reviews</button>
      <button class="nav-item" onclick="switchTab('settings',this)"><span class="nav-icon">âš™ï¸</span>Settings</button>
    </div>
    <div class="sidebar-footer">
      <div class="seller-score-card">
        <div class="sc-label">Seller Score</div>
        <div class="sc-stars">â˜…â˜…â˜…â˜…â˜…</div>
        <div class="sc-score">4.9</div>
        <div class="sc-sub">Top 5% of sellers Â· 312 sales</div>
      </div>
    </div>
  </nav>

  <!-- MAIN CONTENT -->
  <main class="main">

    <!-- â”€â”€ OVERVIEW â”€â”€ -->
    <div class="tab-panel active" id="panel-overview">
      <div class="page-header">
        <div class="ph-top">
          <div>
            <div class="ph-title">Good morning, Henderson Estate ğŸ‘‹</div>
            <div class="ph-sub">Thursday, February 19, 2026 Â· 3 sales active Â· 5 items need attention</div>
          </div>
          <button class="btn-primary" onclick="switchTab('upload',null)">â• Add New Item</button>
        </div>
      </div>

      <div class="stat-grid">
        <div class="stat-card green">
          <div class="stat-icon">ğŸ’°</div>
          <div class="stat-val">$12,840</div>
          <div class="stat-label">Revenue This Month</div>
          <div class="stat-delta up">â†‘ 18% vs last month</div>
        </div>
        <div class="stat-card honey">
          <div class="stat-icon">ğŸ“¦</div>
          <div class="stat-val">24</div>
          <div class="stat-label">Active Listings</div>
          <div class="stat-delta up">â†‘ 6 new this week</div>
        </div>
        <div class="stat-card blue">
          <div class="stat-icon">âš¡</div>
          <div class="stat-val">187</div>
          <div class="stat-label">Total Bids Today</div>
          <div class="stat-delta up">â†‘ 42% vs yesterday</div>
        </div>
        <div class="stat-card red">
          <div class="stat-icon">ğŸšš</div>
          <div class="stat-val">5</div>
          <div class="stat-label">Awaiting Shipment</div>
          <div class="stat-delta down">âš ï¸ Action required</div>
        </div>
        <div class="stat-card green">
          <div class="stat-icon">ğŸ‘ï¸</div>
          <div class="stat-val">3,420</div>
          <div class="stat-label">Listing Views Today</div>
          <div class="stat-delta up">â†‘ 12% vs yesterday</div>
        </div>
        <div class="stat-card honey">
          <div class="stat-icon">â­</div>
          <div class="stat-val">4.9</div>
          <div class="stat-label">Seller Rating</div>
          <div class="stat-delta up">â†‘ 312 reviews total</div>
        </div>
      </div>

      <!-- Alerts -->
      <div class="section-card" style="border-left:4px solid var(--red);padding-left:18px">
        <div class="sc-head"><div class="sc-title">âš ï¸ Action Required</div></div>
        <div style="display:flex;flex-direction:column;gap:8px">
          <div style="display:flex;align-items:center;justify-content:space-between;background:var(--red-pale);border-radius:var(--r-sm);padding:11px 14px">
            <div><span style="font-size:13.5px;font-weight:700;color:var(--red)">ğŸšš 5 items need to ship</span><span style="font-size:12.5px;color:var(--text-mid);margin-left:8px">Sold 3â€“7 days ago â€” buyers waiting</span></div>
            <button class="btn-primary" style="padding:7px 14px;font-size:12.5px" onclick="switchTab('shipping',null)">Ship Now â†’</button>
          </div>
          <div style="display:flex;align-items:center;justify-content:space-between;background:var(--honey-pale);border-radius:var(--r-sm);padding:11px 14px">
            <div><span style="font-size:13.5px;font-weight:700;color:#7a5a20">â° 2 listings ending in under 1 hour</span><span style="font-size:12.5px;color:var(--text-mid);margin-left:8px">Victorian Chair Â· Art Deco Ring</span></div>
            <button class="btn-secondary" style="padding:7px 14px;font-size:12.5px" onclick="switchTab('listings',null)">Monitor â†’</button>
          </div>
          <div style="display:flex;align-items:center;justify-content:space-between;background:var(--blue-pale);border-radius:var(--r-sm);padding:11px 14px">
            <div><span style="font-size:13.5px;font-weight:700;color:var(--blue)">ğŸ’¬ 1 buyer message unanswered</span><span style="font-size:12.5px;color:var(--text-mid);margin-left:8px">Question about the Persian rug dimensions</span></div>
            <button class="btn-secondary" style="padding:7px 14px;font-size:12.5px" onclick="toast('Messages coming soon','ğŸ’¬ Messages')">Reply â†’</button>
          </div>
        </div>
      </div>

      <!-- Active Listings -->
      <div class="section-card">
        <div class="sc-head">
          <div class="sc-title">ğŸ”´ Live Now â€” Top Listings</div>
          <button class="sc-link" onclick="switchTab('listings',null)">View all 24 â†’</button>
        </div>
        <div>
          <div class="listing-row">
            <div class="listing-thumb" style="background:linear-gradient(135deg,#f0e8d8,#e0d0b8)">ğŸª‘</div>
            <div class="listing-content">
              <div class="listing-name">Victorian Carved Mahogany Armchair, c.1890</div>
              <div class="listing-meta">Henderson Estate Â· Listed 3 days ago Â· 18 bids Â· 1,240 views</div>
              <div class="listing-tags"><span class="tag live">ğŸŸ¢ Live</span><span class="tag" style="background:#EEF7EE;color:#2a6040">âœ… Excellent</span></div>
            </div>
            <div class="listing-right">
              <div class="listing-bid">$187</div>
              <div class="listing-bids">18 bids</div>
              <div class="listing-time urgent">1h 42m left</div>
              <div class="listing-actions">
                <button class="act-btn view" onclick="toast('Opening listingâ€¦','ğŸ‘ï¸ View')">View</button>
                <button class="act-btn edit" onclick="openEditModal('Victorian Armchair')">Edit</button>
              </div>
            </div>
          </div>
          <div class="listing-row">
            <div class="listing-thumb" style="background:linear-gradient(135deg,#f8f0e0,#f0e4c0)">ğŸª”</div>
            <div class="listing-content">
              <div class="listing-name">Antique Tiffany-Style Table Lamp</div>
              <div class="listing-meta">Henderson Estate Â· Listed 2 days ago Â· 24 bids Â· 890 views</div>
              <div class="listing-tags"><span class="tag live">ğŸŸ¢ Live</span><span class="tag" style="background:#EEF7EE;color:#2a6040">âœ… Excellent</span></div>
            </div>
            <div class="listing-right">
              <div class="listing-bid">$340</div>
              <div class="listing-bids">24 bids</div>
              <div class="listing-time">4h left</div>
              <div class="listing-actions">
                <button class="act-btn view" onclick="toast('Opening listingâ€¦','ğŸ‘ï¸ View')">View</button>
                <button class="act-btn edit" onclick="openEditModal('Tiffany Lamp')">Edit</button>
              </div>
            </div>
          </div>
          <div class="listing-row">
            <div class="listing-thumb" style="background:linear-gradient(135deg,#f0e8f4,#e0d0e8)">ğŸº</div>
            <div class="listing-content">
              <div class="listing-name">Hand-Knotted Persian Wool Rug, 8Ã—10</div>
              <div class="listing-meta">Henderson Estate Â· Listed 1 day ago Â· 9 bids Â· 560 views</div>
              <div class="listing-tags"><span class="tag live">ğŸŸ¢ Live</span><span class="tag" style="background:#d1ecf1;color:#0c5460">âœ” Good</span><span class="tag pending">ğŸ’¬ Message pending</span></div>
            </div>
            <div class="listing-right">
              <div class="listing-bid">$215</div>
              <div class="listing-bids">9 bids</div>
              <div class="listing-time">1d left</div>
              <div class="listing-actions">
                <button class="act-btn view" onclick="toast('Opening listingâ€¦','ğŸ‘ï¸ View')">View</button>
                <button class="act-btn edit" onclick="openEditModal('Persian Rug')">Edit</button>
              </div>
            </div>
          </div>
          <div class="listing-row">
            <div class="listing-thumb" style="background:linear-gradient(135deg,#e8ecf4,#d8dcec)">ğŸ½ï¸</div>
            <div class="listing-content">
              <div class="listing-name">Set of 12 Wedgwood Dinner Plates</div>
              <div class="listing-meta">Baxter Estate Â· Listed today Â· 7 bids Â· 220 views</div>
              <div class="listing-tags"><span class="tag live">ğŸŸ¢ Live</span><span class="tag" style="background:#EEF7EE;color:#2a6040">âœ… Excellent</span><span class="tag" style="background:#e8f4ff;color:#3B6CB0">ğŸ†• New listing</span></div>
            </div>
            <div class="listing-right">
              <div class="listing-bid">$120</div>
              <div class="listing-bids">7 bids</div>
              <div class="listing-time">1d left</div>
              <div class="listing-actions">
                <button class="act-btn view" onclick="toast('Opening listingâ€¦','ğŸ‘ï¸ View')">View</button>
                <button class="act-btn edit" onclick="openEditModal('Wedgwood Plates')">Edit</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- â”€â”€ UPLOAD NEW ITEM â”€â”€ -->
    <div class="tab-panel" id="panel-upload">
      <div class="page-header">
        <div class="ph-top">
          <div>
            <div class="ph-title">Add New Item</div>
            <div class="ph-sub">List an item for auction â€” AI will help write the description from your photos</div>
          </div>
          <div style="display:flex;gap:10px">
            <button class="btn-secondary" onclick="toast('Saved as draft','ğŸ’¾ Draft Saved')">Save Draft</button>
            <button class="btn-primary" onclick="(async()=>{
  try{
    var title=document.querySelector('[name=item-title]')?.value||document.querySelector('#item-title-input')?.value;
    if(!title){alert('Please enter a title');return;}
    var data={
      title:title,
      description:document.querySelector('#item-desc')?.value||'',
      category:document.querySelector('#item-category')?.value||'Furniture',
      condition:document.querySelector('[data-cond].selected')?.dataset.cond||'good',
      startingBid:document.querySelector('#item-start-bid')?.value||'1',
      endsAt:new Date(Date.now()+7*86400000).toISOString(),
      startsAt:new Date().toISOString(),
      status:'live'
    };
    var result=await FNA.Seller.createItem(data);
    alert('âœ… Item published! ID: '+result.id);
  }catch(e){alert('Error: '+e.message);}
})()" >ğŸš€ Publish Listing</button>
          </div>
        </div>
      </div>

      <div class="section-card">
        <div class="sc-head"><div class="sc-title">ğŸ“¸ Photos</div><span style="font-size:12px;color:var(--text-light)">Upload up to 12 photos. First photo = main image.</span></div>
        <div class="photo-zone" id="drop-zone" onclick="addPhotos()" ondragover="event.preventDefault();this.classList.add('dragover')" ondragleave="this.classList.remove('dragover')" ondrop="handleDrop(event)">
          <div class="pz-icon">ğŸ“·</div>
          <div class="pz-title">Click to upload or drag & drop</div>
          <div class="pz-sub">JPG, PNG, HEIC Â· Max 10MB each Â· Up to 12 photos</div>
        </div>
        <div class="photo-grid" id="photo-grid">
          <div class="photo-thumb-uploaded primary" onclick="toast('Set as primary photo','â­ Primary')">ğŸª‘<span class="photo-primary-badge">Primary</span><button class="remove-btn" onclick="event.stopPropagation();this.parentElement.remove()">âœ•</button></div>
          <div class="photo-thumb-uploaded" onclick="toast('Set as primary photo','â­ Primary')">ğŸ”<button class="remove-btn" onclick="event.stopPropagation();this.parentElement.remove()">âœ•</button></div>
          <div class="photo-thumb-uploaded" onclick="toast('Set as primary photo','â­ Primary')">ğŸªµ<button class="remove-btn" onclick="event.stopPropagation();this.parentElement.remove()">âœ•</button></div>
        </div>
      </div>

      <div class="section-card">
        <div class="sc-head">
          <div class="sc-title">ğŸ“ Item Details</div>
          <button class="ai-btn" onclick="aiGenerateDesc()">ğŸ¤– AI Generate Description</button>
        </div>
        <div class="upload-form">
          <div class="form-group full">
            <label class="form-label">Item Title <span class="req">*</span></label>
            <input class="form-input" type="text" id="item-title" placeholder="e.g. Victorian Carved Mahogany Armchair, c.1890">
          </div>
          <div class="form-group full">
            <label class="form-label">Description <span class="req">*</span></label>
            <textarea class="form-textarea" id="item-desc" placeholder="Describe the item â€” period, materials, provenance, notable featuresâ€¦" style="min-height:130px"></textarea>
            <div class="form-hint">ğŸ’¡ Click "AI Generate Description" above to auto-fill from your photos</div>
          </div>
          <div class="form-group">
            <label class="form-label">Category <span class="req">*</span></label>
            <select class="form-select" id="item-category">
              <option value="">Select categoryâ€¦</option>
              <option>Furniture &amp; Seating</option>
              <option>Art &amp; DÃ©cor</option>
              <option>Jewelry &amp; Watches</option>
              <option>Lighting</option>
              <option>Rugs &amp; Textiles</option>
              <option>Silver &amp; China</option>
              <option>Collectibles</option>
              <option>Books &amp; Ephemera</option>
              <option>Garden &amp; Outdoor</option>
              <option>Other</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Estate Sale</label>
            <select class="form-select">
              <option>Henderson Estate â€” Atlanta, GA</option>
              <option>Baxter Estate â€” Nashville, TN</option>
              <option>+ Create New Sale</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Starting Bid <span class="req">*</span></label>
            <input class="form-input" type="number" id="item-start-bid" placeholder="$1" min="1">
          </div>
          <div class="form-group">
            <label class="form-label">Reserve Price <span style="font-size:11px;color:var(--text-light)">(optional)</span></label>
            <input class="form-input" type="number" id="item-reserve" placeholder="Hidden minimumâ€¦">
            <div class="form-hint">Auction won't complete below this amount</div>
          </div>
          <div class="form-group">
            <label class="form-label">Auction Duration <span class="req">*</span></label>
            <select class="form-select" id="item-duration">
              <option>3 days</option>
              <option selected>5 days</option>
              <option>7 days</option>
              <option>10 days</option>
              <option>14 days</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Dimensions</label>
            <input class="form-input" type="text" id="item-dimensions" placeholder='e.g. 37"H Ã— 26"W Ã— 28"D'>
          </div>
          <div class="form-group">
            <label class="form-label">Weight (for shipping calc)</label>
            <input class="form-input" type="text" id="item-weight" placeholder="e.g. 28 lbs">
          </div>
          <div class="form-group">
            <label class="form-label">Period / Date</label>
            <input class="form-input" type="text" id="item-period" placeholder="e.g. Victorian, c.1890">
          </div>
        </div>
      </div>

      <div class="section-card">
        <div class="sc-head"><div class="sc-title">ğŸ” Condition</div></div>
        <div class="cond-picker" id="cond-picker">
          <div class="cond-opt selected" data-cond="excellent" onclick="selectCond(this)">
            <div class="cond-opt-dot" style="background:#d4edda;border-color:#2a6040"></div>
            <div class="cond-opt-label">Excellent</div>
            <div class="cond-opt-desc">Near perfect, minimal signs of age</div>
          </div>
          <div class="cond-opt" data-cond="good" onclick="selectCond(this)">
            <div class="cond-opt-dot" style="background:#d1ecf1;border-color:#0c5460"></div>
            <div class="cond-opt-label">Good</div>
            <div class="cond-opt-desc">Normal wear consistent with age</div>
          </div>
          <div class="cond-opt" data-cond="fair" onclick="selectCond(this)">
            <div class="cond-opt-dot" style="background:#fff3cd;border-color:#856404"></div>
            <div class="cond-opt-label">Fair</div>
            <div class="cond-opt-desc">Visible wear, repairs, or damage</div>
          </div>
          <div class="cond-opt" data-cond="as-is" onclick="selectCond(this)">
            <div class="cond-opt-dot" style="background:#f8d7da;border-color:#842029"></div>
            <div class="cond-opt-label">As-Is</div>
            <div class="cond-opt-desc">Sold as-is, damage present</div>
          </div>
        </div>
        <div style="margin-top:16px">
          <label class="form-label" style="margin-bottom:6px;display:block">Condition Notes <span style="font-size:11px;color:var(--text-light)">(required for Fair or As-Is)</span></label>
          <textarea class="form-textarea" id="item-condition-notes" placeholder="Describe any damage, repairs, or notable wear â€” be specific. Buyers appreciate full disclosure." style="min-height:80px"></textarea>
        </div>
      </div>

      <div class="section-card">
        <div class="sc-head"><div class="sc-title">ğŸ“¦ Shipping</div></div>
        <div class="upload-form">
          <div class="form-group">
            <label class="form-label">Shipping Method</label>
            <select class="form-select">
              <option>Seller arranges shipping</option>
              <option>USPS Priority Mail</option>
              <option>UPS Ground</option>
              <option>FedEx</option>
              <option>White Glove Delivery</option>
              <option>Local Pickup Only</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Estimated Shipping Cost</label>
            <input class="form-input" type="text" id="item-shipping" placeholder="e.g. $45â€“65 depending on ZIP">
            <div class="form-hint">Shown to buyers before bidding (transparency!)</div>
          </div>
          <div class="form-group full">
            <label class="form-label" style="display:flex;align-items:center;gap:8px;cursor:pointer">
              <input type="checkbox" checked style="width:16px;height:16px;accent-color:var(--green-deep)">
              Offer shipping insurance (recommended)
            </label>
          </div>
        </div>
      </div>

      <div style="display:flex;gap:12px;justify-content:flex-end;padding-top:8px">
        <button class="btn-secondary" onclick="toast('Saved as draft','ğŸ’¾ Draft Saved')">Save Draft</button>
        <button class="btn-primary" style="font-size:15px;padding:13px 28px" onclick="publishListing()">ğŸš€ Publish Listing</button>
      </div>
    </div>

    <!-- â”€â”€ MY LISTINGS â”€â”€ -->
    <div class="tab-panel" id="panel-listings">
      <div class="page-header">
        <div class="ph-top">
          <div><div class="ph-title">My Listings</div><div class="ph-sub">24 total Â· 18 live Â· 3 drafts Â· 3 ended</div></div>
          <button class="btn-primary" onclick="switchTab('upload',null)">â• Add New Item</button>
        </div>
      </div>
      <!-- Filter row -->
      <div style="display:flex;gap:8px;margin-bottom:18px;flex-wrap:wrap">
        <button class="act-btn edit" style="padding:7px 16px;font-size:13px" onclick="toast('Showing all','Filter')">All (24)</button>
        <button class="act-btn view" style="padding:7px 16px;font-size:13px" onclick="toast('Filtered to live','Filter')">ğŸŸ¢ Live (18)</button>
        <button class="act-btn view" style="padding:7px 16px;font-size:13px" onclick="toast('Filtered to drafts','Filter')">ğŸ“ Drafts (3)</button>
        <button class="act-btn view" style="padding:7px 16px;font-size:13px" onclick="toast('Filtered to ended','Filter')">ğŸ Ended (3)</button>
      </div>
      <div class="section-card" style="padding:0">
        <div style="padding:18px 22px;border-bottom:1px solid var(--cream-mid)">
          <input class="form-input" type="text" placeholder="ğŸ” Search your listingsâ€¦" style="max-width:360px">
        </div>
        <div style="padding:0 22px">
          <!-- repeat listing rows -->
          <div class="listing-row"><div class="listing-thumb" style="background:linear-gradient(135deg,#f0e8d8,#e0d0b8)">ğŸª‘</div><div class="listing-content"><div class="listing-name">Victorian Carved Mahogany Armchair, c.1890</div><div class="listing-meta">Henderson Estate Â· 18 bids Â· 1,240 views</div><div class="listing-tags"><span class="tag live">ğŸŸ¢ Live</span><span class="tag" style="background:#EEF7EE;color:#2a6040">âœ… Excellent</span></div></div><div class="listing-right"><div class="listing-bid">$187</div><div class="listing-bids">18 bids</div><div class="listing-time urgent">1h 42m</div><div class="listing-actions"><button class="act-btn view" onclick="toast('Openingâ€¦','View')">View</button><button class="act-btn edit" onclick="openEditModal('Victorian Armchair')">Edit</button></div></div></div>
          <div class="listing-row"><div class="listing-thumb" style="background:linear-gradient(135deg,#f8f0e0,#f0e4c0)">ğŸª”</div><div class="listing-content"><div class="listing-name">Antique Tiffany-Style Table Lamp</div><div class="listing-meta">Henderson Estate Â· 24 bids Â· 890 views</div><div class="listing-tags"><span class="tag live">ğŸŸ¢ Live</span></div></div><div class="listing-right"><div class="listing-bid">$340</div><div class="listing-bids">24 bids</div><div class="listing-time">4h left</div><div class="listing-actions"><button class="act-btn view" onclick="toast('Openingâ€¦','View')">View</button><button class="act-btn edit" onclick="openEditModal('Tiffany Lamp')">Edit</button></div></div></div>
          <div class="listing-row"><div class="listing-thumb" style="background:linear-gradient(135deg,#f0e8f4,#e0d0e8)">ğŸº</div><div class="listing-content"><div class="listing-name">Hand-Knotted Persian Wool Rug, 8Ã—10</div><div class="listing-meta">Henderson Estate Â· 9 bids Â· 560 views</div><div class="listing-tags"><span class="tag live">ğŸŸ¢ Live</span><span class="tag" style="background:#d1ecf1;color:#0c5460">âœ” Good</span></div></div><div class="listing-right"><div class="listing-bid">$215</div><div class="listing-bids">9 bids</div><div class="listing-time">1d left</div><div class="listing-actions"><button class="act-btn view" onclick="toast('Openingâ€¦','View')">View</button><button class="act-btn edit" onclick="openEditModal('Persian Rug')">Edit</button></div></div></div>
          <div class="listing-row"><div class="listing-thumb" style="background:linear-gradient(135deg,#EEF7EE,#d0e4d0)">ğŸ–Šï¸</div><div class="listing-content"><div class="listing-name">Victorian Mahogany Writing Desk</div><div class="listing-meta">Henderson Estate Â· 31 bids Â· 1,880 views</div><div class="listing-tags"><span class="tag live">ğŸŸ¢ Live</span><span class="tag" style="background:#EEF7EE;color:#2a6040">âœ… Excellent</span></div></div><div class="listing-right"><div class="listing-bid">$520</div><div class="listing-bids">31 bids</div><div class="listing-time urgent">2h left</div><div class="listing-actions"><button class="act-btn view" onclick="toast('Openingâ€¦','View')">View</button><button class="act-btn edit" onclick="openEditModal('Writing Desk')">Edit</button></div></div></div>
          <div class="listing-row"><div class="listing-thumb" style="background:var(--cream-mid)">ğŸ“</div><div class="listing-content"><div class="listing-name">1920s Mahogany Side Table â€” DRAFT</div><div class="listing-meta">Henderson Estate Â· Not published Â· Created yesterday</div><div class="listing-tags"><span class="tag draft">ğŸ“ Draft</span></div></div><div class="listing-right"><div class="listing-bid">â€”</div><div class="listing-bids">Not live</div><div class="listing-time">â€”</div><div class="listing-actions"><button class="act-btn edit" onclick="toast('Opening draftâ€¦','Edit Draft')">Edit</button><button class="act-btn danger" onclick="toast('Draft deleted','Deleted')">Delete</button></div></div></div>
          <div class="listing-row"><div class="listing-thumb" style="background:var(--cream-mid)">ğŸ†</div><div class="listing-content"><div class="listing-name">Art Deco Diamond Brooch â€” SOLD</div><div class="listing-meta">Morrison Collection Â· 55 bids Â· Final price: $1,340</div><div class="listing-tags"><span class="tag sold">âœ… Sold</span></div></div><div class="listing-right"><div class="listing-bid">$1,340</div><div class="listing-bids">55 bids</div><div class="listing-time">Ended Feb 17</div><div class="listing-actions"><button class="act-btn view" onclick="toast('Opening archiveâ€¦','View Archive')">View</button></div></div></div>
        </div>
      </div>
    </div>

    <!-- â”€â”€ SHIPPING â”€â”€ -->
    <div class="tab-panel" id="panel-shipping">
      <div class="page-header">
        <div class="ph-top">
          <div><div class="ph-title">Shipping</div><div class="ph-sub">5 items need attention Â· Ship within your stated timeframe to maintain your seller rating</div></div>
          <button class="btn-primary" onclick="generateAllLabels()">ğŸ“¦ Generate All Labels</button>
        </div>
      </div>
      <div class="section-card" style="border-left:4px solid var(--red)">
        <div class="sc-head"><div class="sc-title" style="color:var(--red)">ğŸ”´ Overdue â€” Ship Today</div></div>
        <div class="ship-row header"><div>Item</div><div>Buyer</div><div>Sold For</div><div>Status</div><div></div></div>
        <div class="ship-row"><div><strong>Art Deco Diamond Brooch</strong><div style="font-size:12px;color:var(--text-light)">Morrison Collection Â· Sold 7 days ago</div></div><div>J***n M. Â· Tampa, FL</div><div>$1,340</div><div><span class="ship-status pending">â³ Pending</span></div><div><button class="btn-ship" onclick="toast('Label generated for Art Deco Brooch','ğŸ“¦ Label Created')">Print Label</button></div></div>
        <div class="ship-row"><div><strong>Sterling Silver Tea Service</strong><div style="font-size:12px;color:var(--text-light)">Morrison Collection Â· Sold 5 days ago</div></div><div>R***l P. Â· Chicago, IL</div><div>$512</div><div><span class="ship-status pending">â³ Pending</span></div><div><button class="btn-ship" onclick="toast('Label generated for Tea Service','ğŸ“¦ Label Created')">Print Label</button></div></div>
      </div>
      <div class="section-card">
        <div class="sc-head"><div class="sc-title">ğŸŸ¡ Ship This Week</div></div>
        <div class="ship-row header"><div>Item</div><div>Buyer</div><div>Sold For</div><div>Status</div><div></div></div>
        <div class="ship-row"><div><strong>Wedgwood Dinner Plates (Set/12)</strong><div style="font-size:12px;color:var(--text-light)">Baxter Estate Â· Sold 2 days ago</div></div><div>A***a K. Â· Seattle, WA</div><div>$165</div><div><span class="ship-status label">ğŸ“„ Label Ready</span></div><div><button class="btn-ship" style="background:var(--blue)" onclick="toast('Tracking marked active','âœ… Shipped')">Mark Shipped</button></div></div>
        <div class="ship-row"><div><strong>Botanical Print Collection</strong><div style="font-size:12px;color:var(--text-light)">Carmichael Lot Â· Sold 3 days ago</div></div><div>D***s T. Â· Boston, MA</div><div>$98</div><div><span class="ship-status label">ğŸ“„ Label Ready</span></div><div><button class="btn-ship" style="background:var(--blue)" onclick="toast('Tracking marked active','âœ… Shipped')">Mark Shipped</button></div></div>
      </div>
      <div class="section-card">
        <div class="sc-head"><div class="sc-title">âœ… Recently Shipped</div></div>
        <div class="ship-row header"><div>Item</div><div>Buyer</div><div>Sold For</div><div>Status</div><div></div></div>
        <div class="ship-row"><div><strong>Signed Impressionist Oil Painting</strong><div style="font-size:12px;color:var(--text-light)">Whitfield Gallery Â· Shipped Feb 16</div></div><div>M***e R. Â· New York, NY</div><div>$3,220</div><div><span class="ship-status shipped">âœ… In Transit</span></div><div><button class="act-btn view" onclick="toast('USPS: 9400111899223847382910','ğŸ“¦ Tracking')">Track</button></div></div>
        <div class="ship-row"><div><strong>Victorian Wall Mirror, 36"</strong><div style="font-size:12px;color:var(--text-light)">Henderson Estate Â· Shipped Feb 14</div></div><div>S***h B. Â· Nashville, TN</div><div>$1,020</div><div><span class="ship-status shipped">âœ… Delivered</span></div><div><button class="act-btn view" onclick="toast('Delivered Feb 17 at 2:34 PM','âœ… Delivered')">Details</button></div></div>
      </div>
    </div>

    <!-- â”€â”€ PAYOUTS â”€â”€ -->
    <div class="tab-panel" id="panel-payouts">
      <div class="page-header">
        <div class="ph-top">
          <div><div class="ph-title">Payouts</div><div class="ph-sub">Payments processed within 3 business days of confirmed delivery</div></div>
          <div style="display:flex;gap:10px;flex-wrap:wrap">
            <button class="btn-secondary" onclick="exportCSV()">ğŸ“Š Export CSV</button>
            <button class="btn-primary" onclick="requestPayout(this)">ğŸ’° Request Payout</button>
          </div>
        </div>
      </div>
      <div class="payout-summary">
        <div class="pay-card"><div class="pay-label">Available Balance</div><div class="pay-val green">$8,440</div><div class="pay-sub">Ready to withdraw</div></div>
        <div class="pay-card"><div class="pay-label">Pending</div><div class="pay-val">$3,220</div><div class="pay-sub">Awaiting delivery confirm</div></div>
        <div class="pay-card"><div class="pay-label">This Month</div><div class="pay-val">$12,840</div><div class="pay-sub">Before 15% platform fee</div></div>
        <div class="pay-card"><div class="pay-label">Platform Fee (15%)</div><div class="pay-val" style="color:var(--red)">$1,926</div><div class="pay-sub">Buyer's premium split</div></div>
        <div class="pay-card"><div class="pay-label">Net This Month</div><div class="pay-val green">$10,914</div><div class="pay-sub">After all fees</div></div>
      </div>
      <div class="section-card">
        <div class="sc-head"><div class="sc-title">Transaction History</div></div>
        <table class="payout-table">
          <thead><tr><th>Item</th><th>Sold</th><th>Final Price</th><th>Fee (15%)</th><th>Net</th><th>Status</th></tr></thead>
          <tbody>
            <tr><td><strong>Victorian Mahogany Armchair</strong><div style="font-size:11.5px;color:var(--text-light)">Henderson Estate</div></td><td>Feb 19</td><td>$210</td><td>$31.50</td><td>$178.50</td><td><span class="pay-status processing">âš™ï¸ Processing</span></td></tr>
            <tr><td><strong>Signed Impressionist Painting</strong></td><td>Feb 17</td><td>$3,220</td><td>$483</td><td>$2,737</td><td><span class="pay-status pending">â³ Pending delivery</span></td></tr>
            <tr><td><strong>Art Deco Diamond Brooch</strong></td><td>Feb 14</td><td>$1,340</td><td>$201</td><td>$1,139</td><td><span class="pay-status paid">âœ… Paid</span></td></tr>
            <tr><td><strong>Sterling Silver Tea Service</strong></td><td>Feb 12</td><td>$512</td><td>$76.80</td><td>$435.20</td><td><span class="pay-status paid">âœ… Paid</span></td></tr>
            <tr><td><strong>Victorian Wall Mirror, 36"</strong></td><td>Feb 10</td><td>$1,020</td><td>$153</td><td>$867</td><td><span class="pay-status paid">âœ… Paid</span></td></tr>
            <tr><td><strong>Chinese Export Porcelain Vase</strong></td><td>Feb 8</td><td>$1,265</td><td>$189.75</td><td>$1,075.25</td><td><span class="pay-status paid">âœ… Paid</span></td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- â”€â”€ ANALYTICS â”€â”€ -->
    <div class="tab-panel" id="panel-analytics">
      <div class="page-header">
        <div class="ph-top">
          <div><div class="ph-title">Analytics</div><div class="ph-sub">Last 30 days Â· Henderson Estate portfolio</div></div>
          <select class="form-select" style="width:auto"><option>Last 30 days</option><option>Last 90 days</option><option>This year</option><option>All time</option></select>
        </div>
      </div>
      <div class="stat-grid">
        <div class="stat-card green"><div class="stat-icon">ğŸ’°</div><div class="stat-val">$12,840</div><div class="stat-label">Total Revenue</div><div class="stat-delta up">â†‘ 18% MoM</div></div>
        <div class="stat-card honey"><div class="stat-icon">ğŸ†</div><div class="stat-val">47</div><div class="stat-label">Items Sold</div><div class="stat-delta up">â†‘ 12% MoM</div></div>
        <div class="stat-card blue"><div class="stat-icon">ğŸ‘ï¸</div><div class="stat-val">42.8K</div><div class="stat-label">Total Views</div><div class="stat-delta up">â†‘ 34% MoM</div></div>
        <div class="stat-card green"><div class="stat-icon">âš¡</div><div class="stat-val">$273</div><div class="stat-label">Avg. Selling Price</div><div class="stat-delta up">â†‘ 5% MoM</div></div>
      </div>
      <div class="analytics-grid">
        <div class="chart-card">
          <div class="chart-title">Revenue â€” Last 8 Weeks</div>
          <div class="bar-chart" id="rev-chart"></div>
          <div style="display:flex;justify-content:space-between;margin-top:6px" id="rev-labels"></div>
        </div>
        <div class="chart-card">
          <div class="chart-title">Top Categories by Revenue</div>
          <div class="mini-table">
            <div class="mt-row"><span class="mt-label">ğŸª‘ Furniture</span><span class="mt-val">$5,840 (45%)</span></div>
            <div class="mt-row"><span class="mt-label">ğŸ–¼ï¸ Art &amp; DÃ©cor</span><span class="mt-val">$3,220 (25%)</span></div>
            <div class="mt-row"><span class="mt-label">ğŸ’ Jewelry</span><span class="mt-val">$1,852 (14%)</span></div>
            <div class="mt-row"><span class="mt-label">ğŸ¥„ Silver &amp; China</span><span class="mt-val">$1,027 (8%)</span></div>
            <div class="mt-row"><span class="mt-label">ğŸº Rugs</span><span class="mt-val">$901 (7%)</span></div>
          </div>
        </div>
      </div>
      <div class="analytics-grid">
        <div class="chart-card">
          <div class="chart-title">Sell-Through Rate</div>
          <div style="margin-bottom:12px">
            <div style="display:flex;justify-content:space-between;font-size:13px;margin-bottom:5px"><span style="color:var(--text-mid)">Items sold vs. listed</span><span style="font-weight:700;color:var(--green-deep)">87%</span></div>
            <div style="background:var(--cream-dark);border-radius:4px;height:10px;overflow:hidden"><div style="width:87%;height:100%;background:linear-gradient(90deg,var(--green-deep),var(--green-sage));border-radius:4px"></div></div>
          </div>
          <div style="margin-bottom:12px">
            <div style="display:flex;justify-content:space-between;font-size:13px;margin-bottom:5px"><span style="color:var(--text-mid)">Items with 10+ bids</span><span style="font-weight:700;color:var(--honey)">62%</span></div>
            <div style="background:var(--cream-dark);border-radius:4px;height:10px;overflow:hidden"><div style="width:62%;height:100%;background:linear-gradient(90deg,var(--honey),var(--honey-light));border-radius:4px"></div></div>
          </div>
          <div>
            <div style="display:flex;justify-content:space-between;font-size:13px;margin-bottom:5px"><span style="color:var(--text-mid)">Items above reserve</span><span style="font-weight:700;color:var(--blue)">94%</span></div>
            <div style="background:var(--cream-dark);border-radius:4px;height:10px;overflow:hidden"><div style="width:94%;height:100%;background:linear-gradient(90deg,var(--blue),#6B9FD4);border-radius:4px"></div></div>
          </div>
        </div>
        <div class="chart-card">
          <div class="chart-title">Buyer Geography</div>
          <div class="mini-table">
            <div class="mt-row"><span class="mt-label">Florida</span><span class="mt-val">22%</span></div>
            <div class="mt-row"><span class="mt-label">California</span><span class="mt-val">18%</span></div>
            <div class="mt-row"><span class="mt-label">New York</span><span class="mt-val">15%</span></div>
            <div class="mt-row"><span class="mt-label">Texas</span><span class="mt-val">11%</span></div>
            <div class="mt-row"><span class="mt-label">Other states</span><span class="mt-val">34%</span></div>
          </div>
        </div>
      </div>
    </div>

    <!-- â”€â”€ REVIEWS â”€â”€ -->
    <div class="tab-panel" id="panel-reviews">
      <div class="page-header">
        <div class="ph-top">
          <div><div class="ph-title">Reviews</div><div class="ph-sub">4.9 overall Â· 312 reviews Â· Top 5% of sellers</div></div>
        </div>
      </div>
      <div style="display:grid;grid-template-columns:200px 1fr;gap:22px;margin-bottom:22px;align-items:start">
        <div class="section-card" style="text-align:center">
          <div style="font-family:'Cormorant Garamond',serif;font-size:52px;font-weight:700;color:var(--charcoal);line-height:1">4.9</div>
          <div style="color:var(--honey);font-size:22px;margin:4px 0">â˜…â˜…â˜…â˜…â˜…</div>
          <div style="font-size:13px;color:var(--text-mid)">312 reviews</div>
          <div style="margin-top:14px;display:flex;flex-direction:column;gap:5px">
            <div style="display:flex;align-items:center;gap:7px;font-size:12px"><span style="flex:1;text-align:left;color:var(--text-mid)">Shipping Speed</span><div style="flex:1;background:var(--cream-dark);border-radius:3px;height:6px;overflow:hidden"><div style="width:98%;height:100%;background:var(--honey);border-radius:3px"></div></div><span style="font-weight:700;color:var(--charcoal)">4.9</span></div>
            <div style="display:flex;align-items:center;gap:7px;font-size:12px"><span style="flex:1;text-align:left;color:var(--text-mid)">Item Accuracy</span><div style="flex:1;background:var(--cream-dark);border-radius:3px;height:6px;overflow:hidden"><div style="width:100%;height:100%;background:var(--honey);border-radius:3px"></div></div><span style="font-weight:700;color:var(--charcoal)">5.0</span></div>
            <div style="display:flex;align-items:center;gap:7px;font-size:12px"><span style="flex:1;text-align:left;color:var(--text-mid)">Communication</span><div style="flex:1;background:var(--cream-dark);border-radius:3px;height:6px;overflow:hidden"><div style="width:96%;height:100%;background:var(--honey);border-radius:3px"></div></div><span style="font-weight:700;color:var(--charcoal)">4.8</span></div>
            <div style="display:flex;align-items:center;gap:7px;font-size:12px"><span style="flex:1;text-align:left;color:var(--text-mid)">Packaging</span><div style="flex:1;background:var(--cream-dark);border-radius:3px;height:6px;overflow:hidden"><div style="width:98%;height:100%;background:var(--honey);border-radius:3px"></div></div><span style="font-weight:700;color:var(--charcoal)">4.9</span></div>
          </div>
        </div>
        <div class="section-card">
          <div class="sc-head"><div class="sc-title">Recent Reviews</div></div>
          <div>
            <div class="review-row"><div class="review-head"><div><div class="review-name">Jennifer M.</div><div class="review-stars">â˜…â˜…â˜…â˜…â˜…</div></div><div class="review-date">Feb 18, 2026</div></div><div class="review-text">Absolutely beautiful piece â€” arrived exactly as described, packed incredibly well. The condition photos were spot-on, no surprises. Will definitely buy from this seller again!</div><div class="review-item">Item: Victorian Carved Mahogany Armchair</div></div>
            <div class="review-row"><div class="review-head"><div><div class="review-name">Robert P.</div><div class="review-stars">â˜…â˜…â˜…â˜…â˜…</div></div><div class="review-date">Feb 16, 2026</div></div><div class="review-text">Fast shipping, extremely well packaged, item exactly as described. Best estate auction experience I've had. The price transparency upfront is a huge plus â€” no surprises at checkout.</div><div class="review-item">Item: Sterling Silver Tea Service</div></div>
            <div class="review-row"><div class="review-head"><div><div class="review-name">Sarah K.</div><div class="review-stars">â˜…â˜…â˜…â˜…â˜†</div></div><div class="review-date">Feb 14, 2026</div></div><div class="review-text">Item was in great condition. Shipping took a couple extra days beyond the stated window, but seller communicated proactively about the delay. Very happy with the purchase.</div><div class="review-item">Item: Persian Wool Rug 8Ã—10</div></div>
            <div class="review-row"><div class="review-head"><div><div class="review-name">David T.</div><div class="review-stars">â˜…â˜…â˜…â˜…â˜…</div></div><div class="review-date">Feb 11, 2026</div></div><div class="review-text">Top-notch seller. The signed painting was beyond what I expected â€” gallery quality packaging, certificate of authenticity included. This is how estate auctions should work.</div><div class="review-item">Item: Signed Impressionist Oil Painting</div></div>
          </div>
        </div>
      </div>
    </div>

    <!-- â”€â”€ ESTATE SALES â”€â”€ -->
    <div class="tab-panel" id="panel-sales">
      <div class="page-header">
        <div class="ph-top">
          <div><div class="ph-title">My Estate Sales</div><div class="ph-sub">3 active Â· 2 upcoming Â· 8 completed</div></div>
          <button class="btn-primary" onclick="openNewSaleModal()">ğŸ¡ Create New Sale</button>
        </div>
      </div>
      <div class="sale-card"><div class="sale-status-bar live"></div><div class="sale-content"><div class="sale-title">Henderson Estate â€” Atlanta, GA</div><div class="sale-meta">ğŸŸ¢ Live Â· Feb 15 â€“ Feb 25, 2026 Â· 18 items listed</div><div class="sale-stats"><span class="ss-item">ğŸ’° <strong>$5,840</strong> sold so far</span><span class="ss-item">âš¡ <strong>187</strong> bids today</span><span class="ss-item">ğŸ‘ï¸ <strong>12,400</strong> total views</span><span class="ss-item">ğŸ“¦ <strong>6</strong> items still live</span></div></div><div class="sale-actions"><button class="btn-secondary" onclick="toast('Opening sale managerâ€¦','ğŸ¡ Manage')">Manage</button><button class="btn-primary" onclick="switchTab('upload',null)">+ Add Items</button></div></div>
      <div class="sale-card"><div class="sale-status-bar live"></div><div class="sale-content"><div class="sale-title">Morrison Collection â€” Savannah, GA</div><div class="sale-meta">ğŸŸ¢ Live Â· Feb 10 â€“ Feb 20, 2026 Â· 12 items</div><div class="sale-stats"><span class="ss-item">ğŸ’° <strong>$4,210</strong> sold</span><span class="ss-item">âš¡ <strong>94</strong> bids today</span><span class="ss-item">ğŸ‘ï¸ <strong>8,200</strong> views</span></div></div><div class="sale-actions"><button class="btn-secondary" onclick="toast('Opening sale managerâ€¦','ğŸ¡ Manage')">Manage</button></div></div>
      <div class="sale-card"><div class="sale-status-bar upcoming"></div><div class="sale-content"><div class="sale-title">Baxter Estate â€” Nashville, TN</div><div class="sale-meta">ğŸŸ¡ Upcoming Â· Starts Feb 24, 2026 Â· 8 items ready, 4 drafts</div><div class="sale-stats"><span class="ss-item">ğŸ“ <strong>12</strong> total items</span><span class="ss-item">â³ Starts in <strong>5 days</strong></span></div></div><div class="sale-actions"><button class="btn-secondary" onclick="toast('Editing sale detailsâ€¦','âœï¸ Edit')">Edit</button><button class="btn-primary" onclick="switchTab('upload',null)">+ Add Items</button></div></div>
      <div class="sale-card"><div class="sale-status-bar draft"></div><div class="sale-content"><div class="sale-title">Carmichael Lot â€” Richmond, VA</div><div class="sale-meta">ğŸ“ Draft Â· Not yet scheduled Â· 2 items added</div><div class="sale-stats"><span class="ss-item">ğŸ“ <strong>2</strong> items so far</span></div></div><div class="sale-actions"><button class="btn-secondary" onclick="toast('Editing draftâ€¦','âœï¸ Edit')">Edit</button><button class="btn-danger" onclick="toast('Draft deleted','ğŸ—‘ï¸ Deleted')" style="padding:10px 18px;background:transparent;border:1.5px solid var(--red);color:var(--red);border-radius:var(--r-sm);font-size:13px;font-weight:600;cursor:pointer;font-family:'Jost',sans-serif;transition:all .2s">Delete</button></div></div>
    </div>

    <!-- â”€â”€ SETTINGS â”€â”€ -->
    <div class="tab-panel" id="panel-settings">
      <div class="page-header"><div class="ph-title">Account Settings</div><div class="ph-sub">Manage your seller profile, payout method, and notification preferences</div></div>
      <div class="section-card">
        <div class="sc-head"><div class="sc-title">ğŸ¢ Business Profile</div></div>
        <div class="upload-form">
          <div class="form-group"><label class="form-label">Business Name</label><input class="form-input" value="Henderson Estate Sales"></div>
          <div class="form-group"><label class="form-label">Contact Name</label><input class="form-input" value="Sarah Henderson"></div>
          <div class="form-group"><label class="form-label">Phone</label><input class="form-input" value="(678) 658-3083"></div>
          <div class="form-group"><label class="form-label">Email</label><input class="form-input" value="henderson@familynestauctions.com"></div>
          <div class="form-group full"><label class="form-label">Business Address</label><input class="form-input" value="1234 Peachtree St NE, Atlanta, GA 30309"></div>
          <div class="form-group full"><label class="form-label">Bio / About</label><textarea class="form-textarea">Family-owned estate liquidation service serving Atlanta and surrounding areas since 2014. We specialize in fine antiques, jewelry, and quality home furnishings from distinguished estate collections.</textarea></div>
        </div>
        <div style="margin-top:16px;display:flex;gap:10px;justify-content:flex-end">
          <button class="btn-secondary">Cancel</button>
          <button class="btn-primary" onclick="toast('Profile saved successfully','âœ… Saved')">Save Changes</button>
        </div>
      </div>
      <div class="section-card">
        <div class="sc-head"><div class="sc-title">ğŸ’³ Payout Method</div></div>
        <div style="background:var(--green-pale);border-radius:var(--r-md);padding:16px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px">
          <div style="display:flex;align-items:center;gap:12px"><div style="font-size:24px">ğŸ¦</div><div><div style="font-weight:700;color:var(--charcoal)">Bank Account â€” Chase Â·Â·Â·4521</div><div style="font-size:12.5px;color:var(--text-mid)">ACH transfer Â· 2â€“3 business days</div></div></div>
          <button class="btn-secondary" onclick="openBankModal()">Update Bank</button>
        </div>
      </div>
      <div class="section-card">
        <div class="sc-head"><div class="sc-title">ğŸ”” Notification Settings</div></div>
        <div style="display:flex;flex-direction:column;gap:10px">
          <div style="display:flex;align-items:center;justify-content:space-between;padding:10px 0;border-bottom:1px solid var(--cream-mid)"><div><div style="font-size:13.5px;font-weight:600;color:var(--charcoal)">New bid on your listing</div><div style="font-size:12px;color:var(--text-light)">Email + SMS</div></div><label style="position:relative;width:44px;height:24px;cursor:pointer;display:block"><input type="checkbox" checked style="opacity:0;width:0;height:0;position:absolute"><div style="position:absolute;inset:0;background:var(--green-mid);border-radius:12px"></div><div style="position:absolute;top:3px;left:23px;width:18px;height:18px;background:white;border-radius:50%;box-shadow:0 1px 4px rgba(0,0,0,.2)"></div></label></div>
          <div style="display:flex;align-items:center;justify-content:space-between;padding:10px 0;border-bottom:1px solid var(--cream-mid)"><div><div style="font-size:13.5px;font-weight:600;color:var(--charcoal)">Item sold</div><div style="font-size:12px;color:var(--text-light)">Email + SMS</div></div><label style="position:relative;width:44px;height:24px;cursor:pointer;display:block"><input type="checkbox" checked style="opacity:0;width:0;height:0;position:absolute"><div style="position:absolute;inset:0;background:var(--green-mid);border-radius:12px"></div><div style="position:absolute;top:3px;left:23px;width:18px;height:18px;background:white;border-radius:50%;box-shadow:0 1px 4px rgba(0,0,0,.2)"></div></label></div>
          <div style="display:flex;align-items:center;justify-content:space-between;padding:10px 0;border-bottom:1px solid var(--cream-mid)"><div><div style="font-size:13.5px;font-weight:600;color:var(--charcoal)">Shipping reminder (3 days)</div><div style="font-size:12px;color:var(--text-light)">Email</div></div><label style="position:relative;width:44px;height:24px;cursor:pointer;display:block"><input type="checkbox" checked style="opacity:0;width:0;height:0;position:absolute"><div style="position:absolute;inset:0;background:var(--green-mid);border-radius:12px"></div><div style="position:absolute;top:3px;left:23px;width:18px;height:18px;background:white;border-radius:50%;box-shadow:0 1px 4px rgba(0,0,0,.2)"></div></label></div>
          <div style="display:flex;align-items:center;justify-content:space-between;padding:10px 0;border-bottom:1px solid var(--cream-mid)"><div><div style="font-size:13.5px;font-weight:600;color:var(--charcoal)">Low-bid alert (ending soon)</div><div style="font-size:12px;color:var(--text-light)">Email</div></div><label style="position:relative;width:44px;height:24px;cursor:pointer;display:block"><input type="checkbox" checked style="opacity:0;width:0;height:0;position:absolute"><div style="position:absolute;inset:0;background:var(--green-mid);border-radius:12px"></div><div style="position:absolute;top:3px;left:23px;width:18px;height:18px;background:white;border-radius:50%;box-shadow:0 1px 4px rgba(0,0,0,.2)"></div></label></div>
          <div style="display:flex;align-items:center;justify-content:space-between;padding:10px 0;border-bottom:1px solid var(--cream-mid)"><div><div style="font-size:13.5px;font-weight:600;color:var(--charcoal)">New review received</div><div style="font-size:12px;color:var(--text-light)">Email</div></div><label style="position:relative;width:44px;height:24px;cursor:pointer;display:block"><input type="checkbox" checked style="opacity:0;width:0;height:0;position:absolute"><div style="position:absolute;inset:0;background:var(--green-mid);border-radius:12px"></div><div style="position:absolute;top:3px;left:23px;width:18px;height:18px;background:white;border-radius:50%;box-shadow:0 1px 4px rgba(0,0,0,.2)"></div></label></div>
          <div style="display:flex;align-items:center;justify-content:space-between;padding:10px 0"><div><div style="font-size:13.5px;font-weight:600;color:var(--charcoal)">Weekly performance digest</div><div style="font-size:12px;color:var(--text-light)">Email</div></div><label style="position:relative;width:44px;height:24px;cursor:pointer;display:block"><input type="checkbox" checked style="opacity:0;width:0;height:0;position:absolute"><div style="position:absolute;inset:0;background:var(--green-mid);border-radius:12px"></div><div style="position:absolute;top:3px;left:23px;width:18px;height:18px;background:white;border-radius:50%;box-shadow:0 1px 4px rgba(0,0,0,.2)"></div></label></div>
        </div>
      </div>
      <div class="section-card">
        <div class="sc-head"><div class="sc-title">ğŸ¤ Franchise Opportunities</div></div>
        <div style="background:var(--honey-pale);border-radius:var(--r-md);padding:18px;margin-bottom:16px">
          <div style="font-family:'Cormorant Garamond',serif;font-size:20px;font-weight:700;color:var(--charcoal);margin-bottom:6px">Grow your territory with Family Nest</div>
          <div style="font-size:13.5px;color:var(--text-mid);margin-bottom:12px">Top-performing sellers can apply to operate as a regional Family Nest Auctions partner. Get exclusive territory rights, marketing support, and priority listing placement.</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px">
            <div class="form-group"><label class="form-label">Your Name</label><input class="form-input" id="fr-name" placeholder="Full name"></div>
            <div class="form-group"><label class="form-label">Email</label><input class="form-input" id="fr-email" type="email" placeholder="your@email.com"></div>
            <div class="form-group"><label class="form-label">Target Region / State</label><input class="form-input" id="fr-region" placeholder="e.g. Southeast US / Georgia"></div>
            <div class="form-group"><label class="form-label">Years in Estate Sales</label><input class="form-input" id="fr-years" type="number" min="0" placeholder="5"></div>
          </div>
          <div class="form-group" style="margin-bottom:14px"><label class="form-label">Why are you interested?</label><textarea class="form-textarea" id="fr-message" style="min-height:70px" placeholder="Tell us about your experience and goalsâ€¦"></textarea></div>
          <div id="fr-error" style="color:var(--red);font-size:13px;margin-bottom:10px;display:none"></div>
          <button class="btn-primary" id="fr-btn" onclick="submitFranchise(this)" style="background:var(--honey);color:var(--green-deep)">Submit Interest</button>
        </div>
      </div>
    </div>

  </main>
</div>

<!-- NEW SALE MODAL -->
<div class="overlay" id="new-sale-overlay">
  <div class="modal" style="max-width:500px">
    <button class="modal-x" onclick="closeNewSaleModal()">âœ•</button>
    <h2>ğŸ¡ Create New Estate Sale</h2>
    <p class="modal-sub">Fill in the details to get started. You can add items after creating the sale.</p>
    <div class="form-group" style="margin-bottom:12px"><label class="form-label">Estate / Collection Name</label><input class="form-input" id="ns-name" placeholder="e.g. Henderson Estate â€” Atlanta, GA"></div>
    <div class="form-group" style="margin-bottom:12px"><label class="form-label">Location (City, State)</label><input class="form-input" id="ns-location" placeholder="Atlanta, GA"></div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px">
      <div class="form-group"><label class="form-label">Start Date</label><input class="form-input" id="ns-start" type="date"></div>
      <div class="form-group"><label class="form-label">End Date</label><input class="form-input" id="ns-end" type="date"></div>
    </div>
    <div class="form-group" style="margin-bottom:16px"><label class="form-label">Description (optional)</label><textarea class="form-textarea" id="ns-desc" style="min-height:70px" placeholder="Brief description of the estate collectionâ€¦"></textarea></div>
    <div id="ns-error" style="color:var(--red);font-size:13px;margin-bottom:10px;display:none"></div>
    <div style="display:flex;gap:10px">
      <button class="btn-secondary" onclick="closeNewSaleModal()">Cancel</button>
      <button class="btn-primary" id="ns-btn" onclick="submitNewSale(this)">Create Sale</button>
    </div>
  </div>
</div>

<!-- BANK UPDATE MODAL -->
<div class="overlay" id="bank-overlay">
  <div class="modal" style="max-width:460px">
    <button class="modal-x" onclick="closeBankModal()">âœ•</button>
    <h2>ğŸ’³ Update Payout Method</h2>
    <p class="modal-sub">Enter your bank details for ACH payout. Information is stored securely.</p>
    <div class="form-group" style="margin-bottom:12px"><label class="form-label">Account Holder Name</label><input class="form-input" id="bk-name" placeholder="Full name on account"></div>
    <div style="display:grid;grid-template-columns:2fr 1fr;gap:12px;margin-bottom:12px">
      <div class="form-group"><label class="form-label">Routing Number (9 digits)</label><input class="form-input" id="bk-routing" placeholder="021000021" maxlength="9"></div>
      <div class="form-group"><label class="form-label">Account Number</label><input class="form-input" id="bk-account" placeholder="â€¢â€¢â€¢â€¢4521"></div>
    </div>
    <div class="form-group" style="margin-bottom:16px"><label class="form-label">Account Type</label><select class="form-input" id="bk-type"><option value="checking">Checking</option><option value="savings">Savings</option></select></div>
    <div id="bk-error" style="color:var(--red);font-size:13px;margin-bottom:10px;display:none"></div>
    <div style="display:flex;gap:10px">
      <button class="btn-secondary" onclick="closeBankModal()">Cancel</button>
      <button class="btn-primary" id="bk-btn" onclick="saveBankInfo(this)">Save Bank Info</button>
    </div>
  </div>
</div>

<!-- EDIT MODAL -->
<div class="overlay" id="edit-overlay">
  <div class="modal">
    <button class="modal-x" onclick="closeModal()">âœ•</button>
    <h2>Edit Listing</h2>
    <p class="modal-sub" id="edit-subtitle">Editing item details</p>
    <div class="form-group" style="margin-bottom:14px"><label class="form-label">Title</label><input class="form-input" id="edit-title"></div>
    <div class="form-group" style="margin-bottom:14px"><label class="form-label">Reserve Price</label><input class="form-input" type="number" placeholder="Set or update reserveâ€¦"></div>
    <div class="form-group" style="margin-bottom:14px"><label class="form-label">Condition Notes</label><textarea class="form-textarea" style="min-height:80px" placeholder="Update condition notesâ€¦"></textarea></div>
    <div style="display:flex;gap:10px;margin-top:6px">
      <button class="btn-secondary" onclick="closeModal()">Cancel</button>
      <button class="btn-primary" onclick="toast('Listing updated','âœ… Saved');closeModal()">Save Changes</button>
    </div>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="the-toast"><strong id="t-ttl"></strong><span id="t-msg"></span></div>

<script>
function el(id){return document.getElementById(id)}
function setText(id,v){const e=el(id);if(e)e.textContent=v}
function toast(msg,title){
  const t=el('the-toast');if(!t)return;
  setText('t-ttl',title||'');setText('t-msg',msg);
  t.classList.add('on');setTimeout(()=>t.classList.remove('on'),3400);
}

// Tab switching
function switchTab(name, btn){
  document.querySelectorAll('.tab-panel').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
  const panel=el('panel-'+name);if(panel)panel.classList.add('active');
  if(btn) btn.classList.add('active');
  else {
    document.querySelectorAll('.nav-item').forEach(n=>{
      if(n.getAttribute('onclick')&&n.getAttribute('onclick').includes("'"+name+"'")) n.classList.add('active');
    });
  }
}

// Condition picker
function selectCond(opt){
  document.querySelectorAll('.cond-opt').forEach(o=>o.classList.remove('selected'));
  opt.classList.add('selected');
}

// Edit modal
function openEditModal(name){
  setText('edit-subtitle','Editing: '+name);
  const ti=el('edit-title');if(ti)ti.value=name;
  const ov=el('edit-overlay');if(ov)ov.classList.add('on');
}
function closeModal(){
  const ov=el('edit-overlay');if(ov)ov.classList.remove('on');
}
el('edit-overlay').addEventListener('click',e=>{if(e.target===el('edit-overlay'))closeModal();});

// Publish
function publishItem(){
  const title=el('item-title');
  const name=title&&title.value?title.value:'new item';
  toast('Listing published: '+name,'ğŸš€ Live!');
}

// Real photo upload to Supabase Storage
var _sbSeller=null;
function getSellerSB(){
  if(!_sbSeller) _sbSeller=window.supabase.createClient(
    'https://hwsjgclteuezauveujit.supabase.co',
    'sb_publishable_3-tTloiwTqSEZCw4_m288w_FoR7OgxS'
  );
  return _sbSeller;
}
// Returns the sellers.id (UUID) for the current auth user
async function getCurrentSellerId(){
  var sb=getSellerSB();
  var {data:{user}}=await sb.auth.getUser();
  if(!user) throw new Error('Not signed in.');
  var {data,error}=await sb.from('sellers').select('id').eq('user_id',user.id).single();
  if(error||!data) throw new Error('No seller account found for this user.');
  return data.id;
}
function addPhotos(){
  // Open native file picker
  var input=document.createElement('input');
  input.type='file'; input.accept='image/*'; input.multiple=true;
  input.onchange=function(){ uploadPhotoFiles(Array.from(input.files)); };
  input.click();
}
async function uploadPhotoFiles(files){
  var grid=el('photo-grid'); if(!grid) return;
  var existing=grid.querySelectorAll('.photo-thumb-uploaded').length;
  if(existing+files.length>12){ toast('Max 12 photos per listing','âš ï¸ Max Photos'); return; }
  var sb=getSellerSB();
  var {data:{user}}=await sb.auth.getUser();
  for(var i=0;i<files.length;i++){
    var file=files[i];
    var ext=file.name.split('.').pop()||'jpg';
    var path='seller-'+( user?user.id:'anon')+'/'+Date.now()+'-'+i+'.'+ext;
    var {data:upData,error}=await sb.storage.from('item-photos').upload(path,file,{upsert:true});
    var div=document.createElement('div');
    div.className='photo-thumb-uploaded';
    if(error){
      div.innerHTML='âš ï¸<button class="remove-btn" onclick="event.stopPropagation();this.parentElement.remove()">âœ•</button>';
      div.title='Upload failed: '+error.message;
      toast('Upload failed: '+error.message,'âš ï¸ Error');
    } else {
      var {data:{publicUrl}}=sb.storage.from('item-photos').getPublicUrl(path);
      div.dataset.url=publicUrl;
      div.style.backgroundImage='url('+publicUrl+')';
      div.style.backgroundSize='cover'; div.style.backgroundPosition='center';
      div.innerHTML='<button class="remove-btn" onclick="event.stopPropagation();this.parentElement.remove()">âœ•</button>';
      div.onclick=function(){ document.querySelectorAll('.photo-thumb-uploaded').forEach(function(t){t.dataset.primary='';});this.dataset.primary='1';toast('Set as primary photo','â­ Primary'); };
      toast('Photo uploaded','ğŸ“¸ Uploaded');
    }
    grid.appendChild(div);
  }
}
function handleDrop(e){
  e.preventDefault();
  document.getElementById('drop-zone').classList.remove('dragover');
  uploadPhotoFiles(Array.from(e.dataTransfer.files));
}

// AI description â€” calls Supabase edge function
async function aiGenerateDesc(){
  var btn=document.querySelector('.ai-btn');
  if(btn){btn.textContent='ğŸ¤– Generatingâ€¦';btn.disabled=true;}
  var title=(el('item-title')&&el('item-title').value)||'';
  var category=(el('item-category')&&el('item-category').value)||'Furniture';
  var period=(el('item-period')&&el('item-period').value)||'';
  var selected=document.querySelector('.cond-opt.selected');
  var condition=selected?selected.dataset.cond:'good';
  try {
    var resp=await fetch('https://hwsjgclteuezauveujit.supabase.co/functions/v1/ai-description',{
      method:'POST',
      headers:{
        'Content-Type':'application/json',
        'Authorization':'Bearer sb_publishable_3-tTloiwTqSEZCw4_m288w_FoR7OgxS'
      },
      body:JSON.stringify({title,category,condition,period})
    });
    if(!resp.ok) throw new Error('Edge function returned '+resp.status);
    var data=await resp.json();
    var descText=data.description||data.text||data.result||'';
    if(!descText) throw new Error('Empty response from AI');
    var desc=el('item-desc');
    if(desc) desc.value=descText;
    if(btn){btn.textContent='ğŸ¤– AI Generate Description';btn.disabled=false;}
    toast('Description generated!','ğŸ¤– AI Complete');
  } catch(e) {
    // Fallback to static template if edge function unavailable
    var desc=el('item-desc');
    if(desc&&!desc.value){
      desc.value='A fine example of '+category.toLowerCase()+' from the '+(period||'period')+'. '+
        'Condition: '+condition+'. '+
        (title?'Item: '+title+'. ':'')+'Provenance and additional details available upon request.';
    }
    if(btn){btn.textContent='ğŸ¤– AI Generate Description';btn.disabled=false;}
    toast('AI unavailable â€” sample description added','âš ï¸ Fallback');
  }
}

// Revenue chart
document.addEventListener('DOMContentLoaded',()=>{
  const vals=[3200,2800,4100,3600,4900,3800,5200,4600];
  const labels=['Dec W3','Dec W4','Jan W1','Jan W2','Jan W3','Jan W4','Feb W1','Feb W2'];
  const max=Math.max(...vals);
  const chart=el('rev-chart'), lbls=el('rev-labels');
  if(chart){
    chart.innerHTML=vals.map((v,i)=>`
      <div class="bar-wrap">
        <div class="bar" style="height:${Math.round(v/max*100)}%;background:${i===vals.length-1?'var(--green-deep)':'var(--green-sage)'}">
          <div class="bar-tooltip">$${v.toLocaleString()}</div>
        </div>
      </div>`).join('');
  }
  if(lbls){
    lbls.innerHTML=labels.map(l=>`<div style="flex:1;font-size:9.5px;color:var(--text-light);text-align:center">${l}</div>`).join('');
  }
  document.addEventListener('keydown',e=>{if(e.key==='Escape')closeModal();});
});

// â”€â”€ PAYOUT REQUEST â”€â”€
async function requestPayout(btn){
  if(btn){ btn.textContent='â³ Requestingâ€¦'; btn.disabled=true; }
  try {
    var sb=getSellerSB();
    var sellerId=await getCurrentSellerId();
    var {error}=await sb.from('payout_requests').insert({
      seller_id:sellerId,
      requested_at:new Date().toISOString(),
      status:'pending',
      note:'Requested via seller dashboard'
    });
    if(error) throw error;
    toast('Payout requested â€” arrives in 2â€“3 business days','ğŸ’° Payout Requested');
  } catch(e) {
    toast((e&&e.message)||'Could not request payout','âš ï¸ Error');
  }
  if(btn){ btn.textContent='ğŸ’° Request Payout'; btn.disabled=false; }
}

// â”€â”€ GENERATE ALL LABELS (printable) â”€â”€
function generateAllLabels(){
  var win=window.open('','_blank','width=600,height=800');
  if(!win){ toast('Pop-up blocked â€” allow pop-ups and try again','âš ï¸'); return; }
  win.document.write('<!DOCTYPE html><html><head><title>Shipping Labels â€” Family Nest Auctions</title><style>body{font-family:Arial,sans-serif;padding:20px}@media print{.no-print{display:none}}h2{font-size:16px;border-bottom:1px solid #ccc;padding-bottom:8px;margin-bottom:16px}.label{border:2px solid #333;padding:16px;margin-bottom:20px;page-break-inside:avoid}.from{font-size:12px;color:#666;margin-bottom:8px}.to{font-size:15px;font-weight:bold}.item-info{font-size:12px;color:#444;margin-top:8px;border-top:1px dashed #ccc;padding-top:8px}</style></head><body>');
  win.document.write('<div class="no-print" style="margin-bottom:16px"><button onclick="window.print()" style="padding:10px 22px;background:#3A7A5C;color:white;border:none;border-radius:6px;font-size:14px;cursor:pointer">ğŸ–¨ï¸ Print All Labels</button></div>');
  var items=[
    {name:'Art Deco Diamond Brooch',buyer:'J***n M.',addr:'Tampa, FL 33602',price:'$1,340'},
    {name:'Sterling Silver Tea Service',buyer:'R***l P.',addr:'Chicago, IL 60601',price:'$512'},
    {name:'Victorian Mahogany Armchair',buyer:'K***a T.',addr:'Nashville, TN 37201',price:'$210'}
  ];
  items.forEach(function(it){
    win.document.write('<div class="label"><div class="from">FROM: Henderson Estate Sales Â· 1234 Peachtree St NE, Atlanta, GA 30309</div><div class="to">TO: '+it.buyer+' Â· '+it.addr+'</div><div class="item-info">Item: '+it.name+' Â· Sale price: '+it.price+'<br>Family Nest Auctions â€” familynestauctions.com</div></div>');
  });
  win.document.write('</body></html>');
  win.document.close();
  toast('Label window opened â€” click Print All Labels','ğŸ“¦ Labels Ready');
}

// â”€â”€ CSV EXPORT â”€â”€
function exportCSV(){
  var rows=[['Item','Sale Date','Final Price','Fee (15%)','Net','Status']];
  var tableRows=document.querySelectorAll('.payout-table tbody tr');
  tableRows.forEach(function(tr){
    var cells=tr.querySelectorAll('td');
    rows.push([cells[0]?cells[0].innerText.replace(/\n/g,' '):'',cells[1]?cells[1].innerText:'',cells[2]?cells[2].innerText:'',cells[3]?cells[3].innerText:'',cells[4]?cells[4].innerText:'',cells[5]?cells[5].innerText.replace(/[âœ…âš™ï¸â³]/g,'').trim():'']);
  });
  var csv=rows.map(function(r){return r.map(function(c){return '"'+String(c).replace(/"/g,'""')+'"';}).join(',');}).join('\n');
  var blob=new Blob([csv],{type:'text/csv'});
  var url=URL.createObjectURL(blob);
  var a=document.createElement('a'); a.href=url; a.download='family-nest-payouts-'+new Date().toISOString().slice(0,10)+'.csv';
  document.body.appendChild(a); a.click(); document.body.removeChild(a);
  URL.revokeObjectURL(url);
  toast('CSV downloaded','ğŸ“Š Exported');
}

// â”€â”€ NEW ESTATE SALE MODAL â”€â”€
function openNewSaleModal(){
  var ov=el('new-sale-overlay'); if(ov) ov.classList.add('on');
  // Default dates
  var start=el('ns-start'), end=el('ns-end');
  var today=new Date().toISOString().slice(0,10);
  var inTwoWeeks=new Date(Date.now()+14*86400000).toISOString().slice(0,10);
  if(start&&!start.value) start.value=today;
  if(end&&!end.value) end.value=inTwoWeeks;
}
function closeNewSaleModal(){
  var ov=el('new-sale-overlay'); if(ov) ov.classList.remove('on');
}
async function submitNewSale(btn){
  var name=(el('ns-name')&&el('ns-name').value.trim())||'';
  var location=(el('ns-location')&&el('ns-location').value.trim())||'';
  var startDate=(el('ns-start')&&el('ns-start').value)||'';
  var endDate=(el('ns-end')&&el('ns-end').value)||'';
  var desc=(el('ns-desc')&&el('ns-desc').value.trim())||'';
  var errEl=el('ns-error');
  if(errEl) errEl.style.display='none';
  if(!name){ if(errEl){errEl.textContent='Please enter a sale name.';errEl.style.display='block';} return; }
  if(!startDate||!endDate){ if(errEl){errEl.textContent='Please set start and end dates.';errEl.style.display='block';} return; }
  if(btn){ btn.textContent='Creatingâ€¦'; btn.disabled=true; }
  try {
    var sb=getSellerSB();
    var sellerId=await getCurrentSellerId();
    var locParts=location.split(',').map(function(s){return s.trim();});
    var locCity=locParts[0]||location;
    var locState=locParts[1]||'';
    var {error}=await sb.from('estate_sales').insert({
      seller_id:sellerId,
      name:name,
      location_city:locCity,
      location_state:locState,
      description:desc,
      starts_at:startDate,
      ends_at:endDate,
      status:'upcoming'
    });
    if(error) throw error;
    closeNewSaleModal();
    toast('Estate sale created! Add items from the Upload tab.','ğŸ¡ Sale Created');
    setTimeout(function(){ switchTab('sales',null); },1200);
  } catch(e){
    if(errEl){ errEl.textContent=(e&&e.message)||'Could not create sale.'; errEl.style.display='block'; }
  }
  if(btn){ btn.textContent='Create Sale'; btn.disabled=false; }
}

// â”€â”€ BANK INFO UPDATE â”€â”€
function openBankModal(){
  var ov=el('bank-overlay'); if(ov) ov.classList.add('on');
}
function closeBankModal(){
  var ov=el('bank-overlay'); if(ov) ov.classList.remove('on');
}
async function saveBankInfo(btn){
  var name=(el('bk-name')&&el('bk-name').value.trim())||'';
  var routing=(el('bk-routing')&&el('bk-routing').value.trim())||'';
  var account=(el('bk-account')&&el('bk-account').value.trim())||'';
  var type=(el('bk-type')&&el('bk-type').value)||'checking';
  var errEl=el('bk-error');
  if(errEl) errEl.style.display='none';
  if(!name||!routing||!account){ if(errEl){errEl.textContent='Please fill in all fields.';errEl.style.display='block';} return; }
  if(routing.length!==9||!/^\d+$/.test(routing)){ if(errEl){errEl.textContent='Routing number must be exactly 9 digits.';errEl.style.display='block';} return; }
  if(btn){ btn.textContent='Savingâ€¦'; btn.disabled=true; }
  try {
    var sb=getSellerSB();
    var {data:{user},error:authErr}=await sb.auth.getUser();
    if(authErr||!user) throw new Error('Please sign in first.');
    var masked='Â·Â·Â·'+account.slice(-4);
    var {error}=await sb.from('sellers').update({
      bank_account_holder:name,
      bank_routing_last4:routing.slice(-4),
      bank_account_last4:account.slice(-4),
      bank_account_type:type,
      bank_updated_at:new Date().toISOString()
    }).eq('user_id',user.id);
    if(error) throw error;
    closeBankModal();
    toast('Bank info updated â€” account '+masked,'ğŸ’³ Saved');
  } catch(e){
    if(errEl){ errEl.textContent=(e&&e.message)||'Could not save bank info.'; errEl.style.display='block'; }
  }
  if(btn){ btn.textContent='Save Bank Info'; btn.disabled=false; }
}

function publishListing(){
  var title = document.getElementById('item-title')?.value?.trim();
  var desc = document.getElementById('item-desc')?.value?.trim();
  var category = document.getElementById('item-category')?.value || 'Furniture';
  var startBid = document.getElementById('item-start-bid')?.value;
  var reserve = document.getElementById('item-reserve')?.value;
  var duration = document.getElementById('item-duration')?.value || '7';
  var period = document.getElementById('item-period')?.value || '';
  var condNotes = document.getElementById('item-condition-notes')?.value || '';
  var selected = document.querySelector('.cond-opt.selected');
  var condition = selected ? selected.dataset.cond : 'good';

  if(!title){ alert('Please enter an item title.'); return; }
  if(!startBid || parseFloat(startBid) < 1){ alert('Please enter a starting bid of at least $1.'); return; }

  var endsAt = new Date(Date.now() + parseInt(duration) * 86400000).toISOString();

  var btn = document.querySelector('[onclick*="publishListing"]');
  if(btn){ btn.textContent = 'â³ Publishingâ€¦'; btn.disabled = true; }

  FNA.Seller.createItem({
    title, description: desc, category, condition,
    conditionNotes: condNotes, period,
    startingBid: startBid,
    reservePrice: reserve || null,
    startsAt: new Date().toISOString(),
    endsAt: endsAt,
    status: 'live'
  }).then(function(item){
    if(btn){ btn.textContent = 'ğŸš€ Publish Listing'; btn.disabled = false; }
    toast('Item published successfully! Item ID: ' + item.id.slice(0,8), 'âœ… Published');
    // Clear form
    document.getElementById('item-title').value = '';
    document.getElementById('item-desc').value = '';
    if(document.getElementById('item-start-bid')) document.getElementById('item-start-bid').value = '';
    setTimeout(function(){ switchTab('listings', null); }, 2000);
  }).catch(function(err){
    if(btn){ btn.textContent = 'ğŸš€ Publish Listing'; btn.disabled = false; }
    alert('Could not publish: ' + err.message + '\n\nMake sure you are signed in as a seller.');
  });
}





// â”€â”€ FRANCHISE OPPORTUNITY â”€â”€
async function submitFranchise(btn){
  var name=(el('fr-name')&&el('fr-name').value.trim())||'';
  var email=(el('fr-email')&&el('fr-email').value.trim())||'';
  var region=(el('fr-region')&&el('fr-region').value.trim())||'';
  var years=(el('fr-years')&&el('fr-years').value)||'0';
  var message=(el('fr-message')&&el('fr-message').value.trim())||'';
  var errEl=el('fr-error');
  if(errEl) errEl.style.display='none';
  if(!name||!email){ if(errEl){errEl.textContent='Please enter your name and email.';errEl.style.display='block';} return; }
  if(btn){ btn.textContent='Submittingâ€¦'; btn.disabled=true; }
  try {
    var sb=getSellerSB();
    var {data:{user}}=await sb.auth.getUser();
    var {error}=await sb.from('franchise_leads').insert({
      user_id:user?user.id:null,
      name,email,region,
      years_experience:parseInt(years)||0,
      message,
      submitted_at:new Date().toISOString()
    });
    if(error) throw error;
    toast('Application submitted! Our team will be in touch within 5 business days.','ğŸ¤ Submitted');
    if(el('fr-name')) el('fr-name').value='';
    if(el('fr-email')) el('fr-email').value='';
    if(el('fr-region')) el('fr-region').value='';
    if(el('fr-message')) el('fr-message').value='';
  } catch(e){
    if(errEl){ errEl.textContent=(e&&e.message)||'Could not submit. Please try again.'; errEl.style.display='block'; }
  }
  if(btn){ btn.textContent='Submit Interest'; btn.disabled=false; }
}

function toggleMenu(){
  var h=document.getElementById('hamburger'),m=document.getElementById('mobile-menu');
  if(!h||!m)return;
  h.classList.toggle('open');
  m.classList.toggle('open');
  document.body.style.overflow=m.classList.contains('open')?'hidden':'';
}
</script>
</body>
</html>
